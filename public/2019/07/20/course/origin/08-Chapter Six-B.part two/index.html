<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>原生JS - Chapter Six.B | Edsyang</title><meta name="robots" content="noindex"><meta name="description" content="6. 轮播图（焦点图） 需求：   1.做一个轮播图功能，能够循环自动轮播，当播到最后在一张图片时，再播就要播第一张图片 2.鼠标放到轮播图窗口上，要停止自动轮播，并且左右两个小箭头要出来；点击这两个小箭头可以手动切换（点击左侧小箭头切换上一张，点击右侧小箭头切换下一张）；当鼠标划出时，轮播图还要恢复自动轮播 3.轮播的时候下面的小点要跟着动，上面展示的第几张图片，下面第几个小点要选中 4.点击这"><meta name="keywords" content="JS Notes"><meta name="author" content="Edsyang,edsyang1102@gmail.com"><meta name="copyright" content="Edsyang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.svg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="原生JS - Chapter Six.B"><meta name="twitter:description" content="6. 轮播图（焦点图） 需求：   1.做一个轮播图功能，能够循环自动轮播，当播到最后在一张图片时，再播就要播第一张图片 2.鼠标放到轮播图窗口上，要停止自动轮播，并且左右两个小箭头要出来；点击这两个小箭头可以手动切换（点击左侧小箭头切换上一张，点击右侧小箭头切换下一张）；当鼠标划出时，轮播图还要恢复自动轮播 3.轮播的时候下面的小点要跟着动，上面展示的第几张图片，下面第几个小点要选中 4.点击这"><meta name="twitter:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gegal5ikmoj30u00xpe81.jpg"><meta property="og:type" content="article"><meta property="og:title" content="原生JS - Chapter Six.B"><meta property="og:url" content="http://blog.lagerstroemia.com.cn/2019/07/20/course/origin/08-Chapter%20Six-B.part%20two/"><meta property="og:site_name" content="Edsyang"><meta property="og:description" content="6. 轮播图（焦点图） 需求：   1.做一个轮播图功能，能够循环自动轮播，当播到最后在一张图片时，再播就要播第一张图片 2.鼠标放到轮播图窗口上，要停止自动轮播，并且左右两个小箭头要出来；点击这两个小箭头可以手动切换（点击左侧小箭头切换上一张，点击右侧小箭头切换下一张）；当鼠标划出时，轮播图还要恢复自动轮播 3.轮播的时候下面的小点要跟着动，上面展示的第几张图片，下面第几个小点要选中 4.点击这"><meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gegal5ikmoj30u00xpe81.jpg"><meta property="article:published_time" content="2019-07-20T03:38:34.722Z"><meta property="article:modified_time" content="2020-05-18T16:05:30.542Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://blog.lagerstroemia.com.cn/2019/07/20/course/origin/08-Chapter%20Six-B.part%20two/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: Edsyang","link":"链接: ","source":"来源: Edsyang","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Edsyang" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">124</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">44</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-轮播图（焦点图）"><span class="toc-number">1.</span> <span class="toc-text">6. 轮播图（焦点图）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-轮播图（焦点图）的HTML"><span class="toc-number">1.1.</span> <span class="toc-text">6.1 轮播图（焦点图）的HTML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-1-轮播图（焦点图）的JavaScript-普通"><span class="toc-number">1.2.</span> <span class="toc-text">6.2-1 轮播图（焦点图）的JavaScript - 普通</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-2-轮播图（焦点图）的JavaScript-封装单例"><span class="toc-number">1.3.</span> <span class="toc-text">6.2-2 轮播图（焦点图）的JavaScript - 封装单例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-轮播图（焦点图）的CSS"><span class="toc-number">1.4.</span> <span class="toc-text">6.3 轮播图（焦点图）的CSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-事件-一个时刻"><span class="toc-number">2.</span> <span class="toc-text">7. 事件 - 一个时刻</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-常见的事件"><span class="toc-number">2.1.</span> <span class="toc-text">7.1 常见的事件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-1-鼠标事件"><span class="toc-number">2.1.1.</span> <span class="toc-text">7.1.1 鼠标事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-键盘事件"><span class="toc-number">2.1.2.</span> <span class="toc-text">7.1.2 键盘事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-3-！表单元素事件！"><span class="toc-number">2.1.3.</span> <span class="toc-text">7.1.3 ！表单元素事件！</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-4-系统事件"><span class="toc-number">2.1.4.</span> <span class="toc-text">7.1.4 系统事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-5-移动端事件"><span class="toc-number">2.1.5.</span> <span class="toc-text">7.1.5 移动端事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-事件对象"><span class="toc-number">2.2.</span> <span class="toc-text">7.2 事件对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-默认事件和默认行为"><span class="toc-number">2.3.</span> <span class="toc-text">7.3 默认事件和默认行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-事件传播机制"><span class="toc-number">2.4.</span> <span class="toc-text">7.4 事件传播机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-enter和over的区别"><span class="toc-number">2.5.</span> <span class="toc-text">7.5 enter和over的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-onload和DOMContentLoaded"><span class="toc-number">2.6.</span> <span class="toc-text">7.6 onload和DOMContentLoaded</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-7-事件委托"><span class="toc-number">2.7.</span> <span class="toc-text">7.7 事件委托</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-鼠标跟随"><span class="toc-number">3.</span> <span class="toc-text">8. 鼠标跟随</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-盒子跟随-边界判断"><span class="toc-number">3.1.</span> <span class="toc-text">8.1 盒子跟随 + 边界判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-简单的自定义菜单"><span class="toc-number">3.2.</span> <span class="toc-text">8.2 简单的自定义菜单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-放大镜"><span class="toc-number">3.3.</span> <span class="toc-text">8.3 放大镜</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://tva1.sinaimg.cn/large/007S8ZIlly1gegal5ikmoj30u00xpe81.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Edsyang</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">原生JS - Chapter Six.B</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-07-20 03:38:34"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-07-20</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-05-18 16:05:30"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-05-18</span></time></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">8.7k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 34 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="6-轮播图（焦点图）"><a href="#6-轮播图（焦点图）" class="headerlink" title="6. 轮播图（焦点图）"></a><em>6. 轮播图（焦点图）</em></h2><blockquote>
<p>需求：</p>
</blockquote>
<ul>
<li>1.做一个轮播图功能，能够循环自动轮播，当播到最后在一张图片时，再播就要播第一张图片</li>
<li>2.鼠标放到轮播图窗口上，要停止自动轮播，并且左右两个小箭头要出来；点击这两个小箭头可以手动切换（点击左侧小箭头切换上一张，点击右侧小箭头切换下一张）；当鼠标划出时，轮播图还要恢复自动轮播</li>
<li>3.轮播的时候下面的小点要跟着动，上面展示的第几张图片，下面第几个小点要选中</li>
<li>4.点击这些小点，上面的图片也会切换到相应的图片</li>
</ul>
<blockquote>
<p>原理（左右轮播）</p>
</blockquote>
<ul>
<li>1.在最外层有一个大盒子container，宽高只能显示一张图片，并且设置溢出隐藏（overflow:hidden）</li>
<li>2.在container盒子内还有一个子级的wrapper盒子，wrapper里面放了很多张图片，这些图片的尺寸都是相同的并且都在一行排列</li>
<li>3.wrapper要相对于container绝对定位（position:absolute），默认展示第一张图片，此时wrapper的left值是0</li>
<li>4.所谓轮播：container默认展示第一张图片（索引为0），wrapper的left值为0；当第一次轮播后，container展示第二张图片（索引为1的图片），此时wrapper的left值是负的1张图片的宽度；第二次轮播后container展示第三张图片（索引为2的图片），此时wrapper的left值是负的2张图片的宽度。。。以此类推</li>
<li>5.实现轮播：需要设置一个变量stepIndex，默认值为0，表示container正在展示的图片索引，向后轮播一次，给stepIndex++，然后把wrapper的left设置成 -1 * stepIndex * 图片宽度<blockquote>
<p>wrapper的left的值和container正在展示的图片索引的关系：wrapper的left值 = -1 * 索引 * 图宽</p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th>container正在展示的图片索引</th>
<th>wrapper的left值</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>-1 * 图宽</td>
</tr>
<tr>
<td>2</td>
<td>-2 * 图宽</td>
</tr>
<tr>
<td>3</td>
<td>-3 * 图宽</td>
</tr>
<tr>
<td>n</td>
<td>-n * 图宽</td>
</tr>
</tbody></table>
<blockquote>
<p>轮播图的无缝轮播原理</p>
</blockquote>
<p>向wrapper的末尾多拼接一个第一张图片，当轮播的时候，轮播到最后一张图片时，最后这张图片和第一张图片长得一模一样，此时把wrapper的left的值设置成0，left为0时，container展示的还是第一张图片，因为设为0的这个操作特别快，给人的感觉就是无缝轮播</p>
<blockquote>
<p>思考：wrapper的left设为0以后，stepIndex应该设置为多少 </p>
</blockquote>
<p>1 , 因为最后一张和第一张是相同的，已经展示，如果设置为0，那么还需要再次轮播第一张图；最后一张的跳过和第一张的轮播组合成了无缝的样式，所以第一张完了之后应该轮播第二张，第二张的索引为1</p>
<h3 id="6-1-轮播图（焦点图）的HTML"><a href="#6-1-轮播图（焦点图）的HTML" class="headerlink" title="6.1 轮播图（焦点图）的HTML"></a><em>6.1 轮播图（焦点图）的HTML</em></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/reset.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/style.css"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;div class="slide"&gt;&lt;img src="img/banner1.img" alt=""&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">        &lt;div class="slide"&gt;&lt;img src="img/banner2.img" alt=""&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">        &lt;div class="slide"&gt;&lt;img src="img/banner3.img" alt=""&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">        &lt;div class="slide"&gt;&lt;img src="img/banner4.img" alt=""&gt;&lt;/div&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"focus"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;li class="active"&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">        &lt;li class=""&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">        &lt;li class=""&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">        &lt;li class=""&gt;&lt;/li&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void 0;"</span> <span class="attr">class</span>=<span class="string">"arrow arrowLeft"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void 0;"</span> <span class="attr">class</span>=<span class="string">"arrow arrowRight"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/index.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-2-1-轮播图（焦点图）的JavaScript-普通"><a href="#6-2-1-轮播图（焦点图）的JavaScript-普通" class="headerlink" title="6.2-1 轮播图（焦点图）的JavaScript - 普通"></a><em>6.2-1 轮播图（焦点图）的JavaScript - 普通</em></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 获取元素：jQuery获取来的集合没有DOM映射</span></span><br><span class="line"><span class="keyword">let</span> $container = $(<span class="string">'.container'</span>)</span><br><span class="line"><span class="keyword">let</span> $wrapper = $(<span class="string">'.wrapper'</span>)</span><br><span class="line"><span class="keyword">let</span> $focus = $(<span class="string">'.focus'</span>)</span><br><span class="line"><span class="keyword">let</span> $arrowLeft = $(<span class="string">'.arrowLeft'</span>)</span><br><span class="line"><span class="keyword">let</span> $arrowRight = $(<span class="string">'.arrowRight'</span>)</span><br><span class="line"><span class="keyword">let</span> $slideList = <span class="literal">null</span></span><br><span class="line"><span class="keyword">let</span> $focusList = <span class="literal">null</span></span><br><span class="line"><span class="comment">// 设置轮播参数</span></span><br><span class="line"><span class="keyword">let</span> stepIndex = <span class="number">0</span>; <span class="comment">// 记录container中展示图片的索引，默认展示第一张，第一张图片的索引为0</span></span><br><span class="line"><span class="keyword">let</span> autoTimer = <span class="literal">null</span>; <span class="comment">// 记录定时器ID，以便我们可以清除定时器</span></span><br><span class="line"><span class="keyword">let</span> interval = <span class="number">3000</span> <span class="comment">// 轮播图的轮播间隔</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 获取、绑定数据</span></span><br><span class="line"><span class="comment">// 2.1 请求数据</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">	url: <span class="string">'json/banner.json'</span>,</span><br><span class="line">	type: <span class="string">'GET'</span>,</span><br><span class="line">	dataType: <span class="string">'json'</span>,</span><br><span class="line">	<span class="keyword">async</span>: <span class="literal">true</span>, <span class="comment">// 异步的ajax</span></span><br><span class="line">	error(err)&#123; <span class="comment">// 优先处理错误</span></span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125;,</span><br><span class="line">	success(data)&#123; <span class="comment">// ajax无论异步还是同步执行如果成功都会执行success；但是异步执行时，$.ajax() 后面的代码不会等着ajax结束。</span></span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">		<span class="comment">// 在这里面执行绑定数据的方法</span></span><br><span class="line">		bindHTML() <span class="comment">// bindHTML方法结束后，$focusList重新赋值，不再是null；</span></span><br><span class="line">		handleFocus() <span class="comment">// 上面执行过bindHTML方法后，$focusList有值了，再绑定事件不会报错</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 2.2 绑定数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindHTML</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">	<span class="comment">// 绑定数据需要搞两部分：图片和图片下面的小点（焦点）</span></span><br><span class="line">	<span class="keyword">let</span> slideStr = <span class="string">``</span> <span class="comment">// 准备用来拼接图片</span></span><br><span class="line">	<span class="keyword">let</span> focusStr = <span class="string">``</span> <span class="comment">// 准备用来拼接小点</span></span><br><span class="line">	<span class="comment">// 遍历data拼接字符串</span></span><br><span class="line">	data.forEach(<span class="function">(<span class="params">&#123;img, desc&#125;, index</span>) =&gt;</span> &#123;</span><br><span class="line">    	slideStr += <span class="string">`&lt;div class="slide"&gt;&lt;img src="<span class="subst">$&#123;img&#125;</span>" alt="<span class="subst">$&#123;desc&#125;</span>"&gt;&lt;/div&gt;`</span></span><br><span class="line">    	focusStr += <span class="string">`&lt;li class="<span class="subst">$&#123;index === <span class="number">0</span> ? <span class="string">'active'</span> : <span class="string">''</span>&#125;</span>"&gt;&lt;/li&gt;`</span></span><br><span class="line">    	<span class="comment">// 轮播图默认展示第一张图片，所以第一个小点默认选中；data中的第一条数据，对应的是第一张图片，第一条数据的索引index是0，所以判断index为0返回active</span></span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">// 为了无缝轮播：需要给wrapper最后多拼接一个第一张图片，data里面的第一条数据就是第一张图片；</span></span><br><span class="line">	slideStr += <span class="string">`&lt;div class="slide"&gt;&lt;img src="<span class="subst">$&#123;data[<span class="number">0</span>].img&#125;</span>" alt="<span class="subst">$&#123;data[<span class="number">0</span>].desc&#125;</span>"&gt;&lt;/div&gt;`</span></span><br><span class="line">	<span class="comment">// 把拼接好的字符串插入到页面元素中</span></span><br><span class="line">  	$wrapper.html(slideStr)</span><br><span class="line">	$focus.html(focusStr)</span><br><span class="line">	<span class="comment">// 重新获取slideList和focusList</span></span><br><span class="line">  	$slideList = $(<span class="string">'.slide'</span>)</span><br><span class="line">	$focusList = $(<span class="string">'.focus &gt; li'</span>)</span><br><span class="line">	<span class="comment">// 动态设置wrapper的宽度</span></span><br><span class="line">  	$wrapper.css(&#123;</span><br><span class="line">    	width: $slideList.length * <span class="number">1000</span> <span class="comment">/*1000 是图片宽度*/</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3. autoMove 实现轮播  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">autoMove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  	stepIndex++; <span class="comment">// stepIndex记录的container展示图片的索引</span></span><br><span class="line">  	<span class="comment">// stepIndex = $slideList.length - 1时，container中展示的是最后一张图片（因为最后一张图片是复制的第一张图片，用户看到的是第一张图）；</span></span><br><span class="line">  	<span class="keyword">if</span> (stepIndex &gt;= $slideList.length) &#123;</span><br><span class="line">    	$wrapper.css(<span class="string">'left'</span>, <span class="number">0</span>); <span class="comment">// 此时我们把wrapper的left值设置成0，container展示的还是第一张图片；再轮播就该轮播第二张，第二张图片的索引为1，所以stepIndex的值应该设置为1；</span></span><br><span class="line">    	stepIndex = <span class="number">1</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="comment">// 让wrapper的动画到：-1 * stepIndex * 图片宽度</span></span><br><span class="line">  	$wrapper.stop().animate(&#123;</span><br><span class="line">    	left: <span class="number">-1</span> * stepIndex * <span class="number">1000</span></span><br><span class="line">  	&#125;, <span class="number">500</span>);</span><br><span class="line">  	changeFocus(); <span class="comment">// 在这里调用焦点跟随的方法</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 4. 鼠标划入container停止轮播，叫左右两个箭头显示出来；鼠标划出时，重自动轮播，把两个小箭头隐藏掉</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleContainer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  	$container.on(<span class="string">'mouseenter'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="comment">// 4.1 停止自动轮播</span></span><br><span class="line">    	clearInterval(autoTimer);</span><br><span class="line">    	<span class="comment">// 4.2 让两个箭头出来</span></span><br><span class="line">    	$arrowLeft.css(&#123;</span><br><span class="line">      		display: <span class="string">'block'</span></span><br><span class="line">    	&#125;)</span><br><span class="line">    	$arrowRight.css(&#123;</span><br><span class="line">    	  display: <span class="string">'block'</span></span><br><span class="line">    	&#125;)</span><br><span class="line">  	&#125;).on(<span class="string">'mouseleave'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="comment">// 重启自动轮播，再重新开一个定时器，就会继续自动轮播</span></span><br><span class="line">    	autoTimer = setInterval(autoMove, interval);</span><br><span class="line">    	$arrowLeft.css(&#123;</span><br><span class="line">    	  display: <span class="string">'none'</span></span><br><span class="line">    	&#125;)</span><br><span class="line">    	$arrowRight.css(&#123;</span><br><span class="line">    	  display: <span class="string">'none'</span></span><br><span class="line">    	&#125;)</span><br><span class="line">  	&#125;)</span><br><span class="line">&#125;</span><br><span class="line">handleContainer();</span><br><span class="line"><span class="comment">// 5. 实现焦点跟随</span></span><br><span class="line"><span class="comment">// 焦点跟随：播第一张图片，第一个焦点选中，播第二个图片，第二个选中，而stepIndex控制着播哪个图片；焦点跟随就是把索引和stepIndex相同的焦点设置为选中样式，其他的小点清除选中样式；</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeFocus</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="keyword">let</span> tmpIndex = stepIndex; <span class="comment">// 因为stepIndex控制着轮播，所以我们复制一份stepIndex值，避免直接修改stepIndex</span></span><br><span class="line">  	<span class="keyword">if</span> (tmpIndex === $slideList.length - <span class="number">1</span>) &#123;</span><br><span class="line">    	tmpIndex = <span class="number">0</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">  	$focusList.eq(tmpIndex).addClass(<span class="string">'active'</span>).siblings().removeClass(<span class="string">'active'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 6. 处理小箭头的点击事件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleArrow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="comment">// 6.1 右边的箭头的功能就是去播下一张，我们的autoMove方法专门用来播下一张的；</span></span><br><span class="line">  	$arrowRight.click(autoMove) <span class="comment">// click方法传一个回调函数，而autoMove是函数名，代表一个函数</span></span><br><span class="line">  	$arrowLeft.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="comment">// 点击左侧箭头切换到上一张，stepIndex控制着播那张图，stepIndex++是播下一张，stepIndex--就是播上一张</span></span><br><span class="line">    	stepIndex-- <span class="comment">// stepIndex减到0的时候，container里面展示的就是第一张图片了，如果再减我们需要展示真实的最后一张图片的内容（因为前面为了实现无缝轮播，我们把第一张图片复制了一份放到了wrapper的末尾，length - 1 的展示还是第一张图片）</span></span><br><span class="line">    	<span class="keyword">if</span> (stepIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      		stepIndex = $slideList.length - <span class="number">2</span></span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="comment">// 让wrapper动画到指定位置</span></span><br><span class="line">    	$wrapper.stop().animate(&#123;</span><br><span class="line">    	  left: <span class="number">-1</span> * stepIndex * <span class="number">1000</span></span><br><span class="line">    	&#125;, <span class="number">500</span>)</span><br><span class="line">    	<span class="comment">// 焦点跟随</span></span><br><span class="line">    	changeFocus()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">handleArrow()</span><br><span class="line"><span class="comment">// 7. 处理焦点的点击事件：点击第一个小点，container展示第一张图片，点击第二个小点，container展示第二张图片......，而stepIndex控制着播放图片的索引，所以我们stepIndex设置成被点击小点的索引；</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleFocus</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> 	$focusList.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="keyword">let</span> index = $(<span class="keyword">this</span>).index() <span class="comment">// this是原生对象，index() 是jq的方法，所以需要先把this转成jq对象，用 $(this) 方式；</span></span><br><span class="line">    	stepIndex = index</span><br><span class="line">    	<span class="comment">// 让wrapper动画到指定位置</span></span><br><span class="line">    	$wrapper.stop().animate(&#123;</span><br><span class="line">      		left: <span class="number">-1</span> * stepIndex * <span class="number">1000</span></span><br><span class="line">    	&#125;, <span class="number">500</span>);</span><br><span class="line">		<span class="comment">// 焦点跟随</span></span><br><span class="line">    	changeFocus();</span><br><span class="line">  	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// handleFocus(); 因为ajax是异步的，这里执行 handleFocus() 是同步执行，此时$focusList还是null，再给null绑定事件就会报错；</span></span><br><span class="line">autoTimer = setInterval(autoMove, interval);</span><br></pre></td></tr></table></figure>

<h3 id="6-2-2-轮播图（焦点图）的JavaScript-封装单例"><a href="#6-2-2-轮播图（焦点图）的JavaScript-封装单例" class="headerlink" title="6.2-2 轮播图（焦点图）的JavaScript - 封装单例"></a><em>6.2-2 轮播图（焦点图）的JavaScript - 封装单例</em></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> bannerRender = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="comment">// 1. 获取元素: jq获取来的集合没有dom映射；</span></span><br><span class="line">  	<span class="keyword">let</span> $container = $(<span class="string">'.container'</span>)</span><br><span class="line">  	<span class="keyword">let</span> $wrapper = $(<span class="string">'.wrapper'</span>)</span><br><span class="line">  	<span class="keyword">let</span> $focus = $(<span class="string">'.focus'</span>)</span><br><span class="line">  	<span class="keyword">let</span> $arrowLeft = $(<span class="string">'.arrowLeft'</span>)</span><br><span class="line">  	<span class="keyword">let</span> $arrowRight = $(<span class="string">'.arrowRight'</span>)</span><br><span class="line">  	<span class="keyword">let</span> $slideList = <span class="literal">null</span></span><br><span class="line">  	<span class="keyword">let</span> $focusList = <span class="literal">null</span></span><br><span class="line">	<span class="comment">// 配置轮播参数：</span></span><br><span class="line">  	<span class="keyword">let</span> stepIndex = <span class="number">0</span> <span class="comment">// 记录container中展示图片的索引，默认展示第一张，第一张图片的索引为0</span></span><br><span class="line">  	<span class="keyword">let</span> autoTimer = <span class="literal">null</span> <span class="comment">// 记录定时器ID，以便我们可以清除定时器</span></span><br><span class="line">  	<span class="keyword">let</span> interval = <span class="number">3000</span> <span class="comment">// 轮播图的轮播间隔</span></span><br><span class="line">  	<span class="comment">// 2. 获取数据，绑定数据；</span></span><br><span class="line">  	<span class="comment">// 2.1 请求数据</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">queryData</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	$.ajax(&#123;</span><br><span class="line">      		url: <span class="string">'json/banner.json'</span>,</span><br><span class="line">      		method: <span class="string">'GET'</span>,</span><br><span class="line">      		dataType: <span class="string">'json'</span>,</span><br><span class="line">      		<span class="keyword">async</span>: <span class="literal">false</span>,</span><br><span class="line">      		error (err) &#123;</span><br><span class="line">      		  <span class="built_in">console</span>.log(err)</span><br><span class="line">      		&#125;,</span><br><span class="line">      		success (data) &#123;</span><br><span class="line">      		  <span class="built_in">console</span>.log(data)</span><br><span class="line">      		  <span class="comment">// 在这里面执行绑定数据的方法</span></span><br><span class="line">      		  bindHTML(data)</span><br><span class="line">      		&#125;</span><br><span class="line">    	&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">  	<span class="comment">// 2.2 绑定数据</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">bindHTML</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    	<span class="comment">// 绑定数据需要搞两部分：图片和图片下面的小点（焦点）</span></span><br><span class="line">    	<span class="keyword">let</span> slideStr = <span class="string">``</span> <span class="comment">// 准备用来拼接图片</span></span><br><span class="line">    	<span class="keyword">let</span> focusStr = <span class="string">``</span> <span class="comment">// 准备用来拼接小点</span></span><br><span class="line">    	<span class="comment">// 遍历data拼接字符串</span></span><br><span class="line">    	data.forEach(<span class="function">(<span class="params">&#123;img, desc&#125;, index</span>) =&gt;</span> &#123;</span><br><span class="line">      		slideStr += <span class="string">`&lt;div class="slide"&gt;&lt;img src="<span class="subst">$&#123;img&#125;</span>" alt="<span class="subst">$&#123;desc&#125;</span>"&gt;&lt;/div&gt;`</span>;</span><br><span class="line">      		focusStr += <span class="string">`&lt;li class="<span class="subst">$&#123;index === <span class="number">0</span> ? <span class="string">'active'</span> : <span class="string">''</span>&#125;</span>"&gt;&lt;/li&gt;`</span></span><br><span class="line">      		<span class="comment">// 轮播图默认展示第一张图片，所以第一个小点默认选中；data中的第一条数据，对应的是第一张图片，第一条数据的索引index是0，所以判断index为0返回active</span></span><br><span class="line">    	&#125;);</span><br><span class="line">    	<span class="comment">// 为了无缝轮播：需要给wrapper最后多拼接一个第一张图片，data里面的第一条数据就是第一张图片；</span></span><br><span class="line">    	slideStr += <span class="string">`&lt;div class="slide"&gt;&lt;img src="<span class="subst">$&#123;data[<span class="number">0</span>].img&#125;</span>" alt="<span class="subst">$&#123;data[<span class="number">0</span>].desc&#125;</span>"&gt;&lt;/div&gt;`</span>;</span><br><span class="line">    	<span class="comment">// 把拼接好的字符串插入到页面元素中</span></span><br><span class="line">    	$wrapper.html(slideStr);</span><br><span class="line">    	$focus.html(focusStr);</span><br><span class="line">    	<span class="comment">// 重新获取slideList和focusList</span></span><br><span class="line">    	$slideList = $(<span class="string">'.slide'</span>);</span><br><span class="line">    	$focusList = $(<span class="string">'.focus &gt; li'</span>);</span><br><span class="line">    	<span class="comment">// 动态设置wrapper的宽度</span></span><br><span class="line">    	$wrapper.css(&#123;</span><br><span class="line">    	  width: $slideList.length * <span class="number">1000</span> <span class="comment">/*1000 是图片宽度*/</span></span><br><span class="line">    	&#125;);</span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="comment">// 3. autoMove 实现轮播</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">autoMove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	stepIndex++; <span class="comment">// stepIndex记录的container展示图片的索引</span></span><br><span class="line">    	<span class="comment">// stepIndex = $slideList.length - 1时，container中展示的是最后一张图片（因为最后一张图片是复制的第一张图片，用户看到的是第一张图）；</span></span><br><span class="line">    	<span class="keyword">if</span> (stepIndex &gt;= $slideList.length) &#123;</span><br><span class="line">      		$wrapper.css(<span class="string">'left'</span>, <span class="number">0</span>); <span class="comment">// 此时我们把wrapper的left值设置成0，container展示的还是第一张图片；再轮播就该轮播第二张，第二张图片的索引为1，所以stepIndex的值应该设置为1；</span></span><br><span class="line">      		stepIndex = <span class="number">1</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="comment">// 让wrapper的动画到：-1 * stepIndex * 图片宽度</span></span><br><span class="line">    	$wrapper.stop().animate(&#123;</span><br><span class="line">    	  left: <span class="number">-1</span> * stepIndex * <span class="number">1000</span></span><br><span class="line">    	&#125;, <span class="number">500</span>);</span><br><span class="line">    	changeFocus(); <span class="comment">// 在这里调用焦点跟随的方法</span></span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="comment">// 4. 鼠标划入container停止轮播，叫左右两个箭头显示出来；鼠标划出时，重自动轮播，把两个小箭头隐藏掉</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">handleContainer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	$container.on(<span class="string">'mouseenter'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      		<span class="comment">// 4.1 停止自动轮播</span></span><br><span class="line">      		clearInterval(autoTimer);</span><br><span class="line">      		<span class="comment">// 4.2 让两个箭头出来</span></span><br><span class="line">      		$arrowLeft.css(&#123;</span><br><span class="line">      		  display: <span class="string">'block'</span></span><br><span class="line">      		&#125;);</span><br><span class="line">      		$arrowRight.css(&#123;</span><br><span class="line">      		  display: <span class="string">'block'</span></span><br><span class="line">      		&#125;)</span><br><span class="line">    	&#125;).on(<span class="string">'mouseleave'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      		<span class="comment">// 重启自动轮播，再重新开一个定时器，就会继续自动轮播</span></span><br><span class="line">      		autoTimer = setInterval(autoMove, interval);</span><br><span class="line">      		$arrowLeft.css(&#123;</span><br><span class="line">      		  display: <span class="string">'none'</span></span><br><span class="line">      		&#125;);</span><br><span class="line">      		$arrowRight.css(&#123;</span><br><span class="line">      		  display: <span class="string">'none'</span></span><br><span class="line">      		&#125;);</span><br><span class="line">    	&#125;)</span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="comment">// 5. 实现焦点跟随</span></span><br><span class="line">  	<span class="comment">// 焦点跟随：播第一张图片，第一个焦点选中，播第二个图片，第二个选中，而stepIndex控制着播哪个图片；焦点跟随就是把索引和stepIndex相同的焦点设置为选中样式，其他的小点清除选中样式；</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">changeFocus</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="keyword">let</span> tmpIndex = stepIndex; <span class="comment">// 因为stepIndex控制着轮播，所以我们复制一份stepIndex值，避免直接修改stepIndex</span></span><br><span class="line">    	<span class="keyword">if</span> (tmpIndex === $slideList.length - <span class="number">1</span>) &#123;</span><br><span class="line">      		tmpIndex = <span class="number">0</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	$focusList.eq(tmpIndex).addClass(<span class="string">'active'</span>).siblings().removeClass(<span class="string">'active'</span>);</span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="comment">// 6. 处理小箭头的点击事件</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">handleArrow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="comment">// 6.1 右边的箭头的功能就是去播下一张，我们的autoMove方法专门用来播下一张的；</span></span><br><span class="line">    	$arrowRight.click(autoMove); <span class="comment">// click方法传一个回调函数，而autoMove是函数名，代表一个函数</span></span><br><span class="line">    	$arrowLeft.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      		<span class="comment">// 点击左侧箭头切换到上一张，stepIndex控制着播那张图，stepIndex++是播下一张，stepIndex--就是播上一张</span></span><br><span class="line">      		stepIndex--; <span class="comment">// stepIndex减到0的时候，container里面展示的就是第一张图片了，如果再减我们需要展示真实的最后一张图片的内容（因为前面为了实现无缝轮播，我们把第一张图片复制了一份放到了wrapper的末尾，length - 1 的展示还是第一张图片）</span></span><br><span class="line">      		<span class="keyword">if</span> (stepIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        		stepIndex = $slideList.length - <span class="number">2</span>;</span><br><span class="line">      		&#125;</span><br><span class="line">      		<span class="comment">// 让wrapper动画到指定位置</span></span><br><span class="line">      		$wrapper.stop().animate(&#123;</span><br><span class="line">      		  left: <span class="number">-1</span> * stepIndex * <span class="number">1000</span></span><br><span class="line">      		&#125;, <span class="number">500</span>);</span><br><span class="line">      		<span class="comment">// 焦点跟随</span></span><br><span class="line">      		changeFocus();</span><br><span class="line">    	&#125;);</span><br><span class="line"> 	&#125;</span><br><span class="line">  	<span class="comment">// 7. 处理焦点的点击事件：点击第一个小点，container展示第一张图片，点击第二个小点，container展示第二张图片......，而stepIndex控制着播放图片的索引，所以我们stepIndex设置成被点击小点的索引；</span></span><br><span class="line">  	<span class="function"><span class="keyword">function</span> <span class="title">handleFocus</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	$focusList.click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      		<span class="keyword">let</span> index = $(<span class="keyword">this</span>).index(); <span class="comment">// this是原生对象，index() 是jq的方法，所以需要先把this转成jq对象，用 $(this) 方式；</span></span><br><span class="line">      		stepIndex = index;</span><br><span class="line">      		<span class="comment">// 让wrapper动画到指定位置</span></span><br><span class="line">      		$wrapper.stop().animate(&#123;</span><br><span class="line">      		  left: <span class="number">-1</span> * stepIndex * <span class="number">1000</span></span><br><span class="line">      		&#125;, <span class="number">500</span>);</span><br><span class="line">      		<span class="comment">// 焦点跟随</span></span><br><span class="line">      		changeFocus();</span><br><span class="line">    	&#125;);</span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="keyword">return</span> &#123;</span><br><span class="line">    	init () &#123;</span><br><span class="line">      		queryData();</span><br><span class="line">      		handleContainer();</span><br><span class="line">      		handleArrow();</span><br><span class="line">      		handleFocus();</span><br><span class="line">      		autoTimer = setInterval(autoMove, interval);</span><br><span class="line">    	&#125;</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;)()</span><br><span class="line">bannerRender.init()</span><br></pre></td></tr></table></figure>

<h3 id="6-3-轮播图（焦点图）的CSS"><a href="#6-3-轮播图（焦点图）的CSS" class="headerlink" title="6.3 轮播图（焦点图）的CSS"></a><em>6.3 轮播图（焦点图）的CSS</em></h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">4000px</span>; <span class="comment">/*根据JS中获取的数据动态控制宽度*/</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.wrapper</span> <span class="selector-class">.slide</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.wrapper</span> <span class="selector-class">.slide</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.focus</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">999</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>); <span class="comment">/*基于CSS3中的TRANSFORM变形属性，在不固定的宽度的情况下实现水品居中 translateX:让当前元素在水平方向发生位移(此处-50%向左移动当前盒子的一半)*/</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>; <span class="comment">/*让其为盒子高度的一半,这样把长方型的盒子修改为椭圆状*/</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.focus</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#FFF</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.focus</span> <span class="selector-tag">li</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#DB192A</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.arrow</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">22.5px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">28px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">45px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"../img/pre.png"</span>) no-repeat;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.arrow</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.arrow</span><span class="selector-class">.arrowLeft</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.arrow</span><span class="selector-class">.arrowRight</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">50px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-事件-一个时刻"><a href="#7-事件-一个时刻" class="headerlink" title="7. 事件 - 一个时刻"></a><em>7. 事件 - 一个时刻</em></h2><p>文档（html元素及document）或者浏览器窗口发生的一些特定的交互瞬间；一般给事件绑定一个事件监听函数来监听这些事件，以实现在事件发生时执行特定（需要）的操作</p>
<p>IE不兼容，IE的事件对象存放在window.event属性上</p>
<h3 id="7-1-常见的事件"><a href="#7-1-常见的事件" class="headerlink" title="7.1 常见的事件"></a><em>7.1 常见的事件</em></h3><p>事件函数都是在事件触发时浏览器执行的；给元素的事件属性赋值一个函数，这个行为叫做监听事件</p>
<h4 id="7-1-1-鼠标事件"><a href="#7-1-1-鼠标事件" class="headerlink" title="7.1.1 鼠标事件"></a><em>7.1.1 鼠标事件</em></h4><p>鼠标动作时触发的事件</p>
<pre><code>onclick 单击事件
ondblclick 双击事件

onmouseover 鼠标划入事件
onmouseout 鼠标划出事件

onmouseenter 鼠标进入事件
onmouseleave 鼠标离开事件

onmousedown 鼠标左键按下事件
onmouseup 鼠标左键抬起事件
&lt;!-- onmousedown、onmouseup可以做拖拽 --&gt;

onmousemove 鼠标移动事件
onmousewheel 鼠标滚轮滚动事件
oncontextmenu 鼠标右键事件（右键弹出自定义菜单就需要oncontextmenu）</code></pre><h4 id="7-1-2-键盘事件"><a href="#7-1-2-键盘事件" class="headerlink" title="7.1.2 键盘事件"></a><em>7.1.2 键盘事件</em></h4><pre><code>onkeydown 键盘按键按下事件
onkeyup 键盘按键弹起事件
onkeypress 按键事件（有兼容性问题）</code></pre><blockquote>
<p>一般 input、textarea、document、documentElement、document.body、window 需要绑定键盘事件；其他标签如div、p、a…一般不需要键盘事件</p>
</blockquote>
<h4 id="7-1-3-！表单元素事件！"><a href="#7-1-3-！表单元素事件！" class="headerlink" title="7.1.3 ！表单元素事件！"></a><em>7.1.3 ！表单元素事件！</em></h4><p>表单元素：input、textarea、select（下拉列表）、checkbox、radio、form</p>
<pre><code>onfocus 获得焦点时触发：得焦事件
onblur 失去焦点时触发：失焦事件
oninput 输入事件：输入时触发
onchange 表单的值发生改变时触发
onsubmit form表单提交的时候会触发</code></pre><h4 id="7-1-4-系统事件"><a href="#7-1-4-系统事件" class="headerlink" title="7.1.4 系统事件"></a><em>7.1.4 系统事件</em></h4><pre><code>window.onload 页面中所有的资源全部加载完成后触发
window.onresize 浏览器窗口的尺寸发生改变时触发
window.onscroll 浏览器窗口滚动条滚动的时候触发</code></pre><blockquote>
<p>DOMContentLoaded （DOM2级事件）页面的DOM解构加载并解析完成就会触发 用法：document.addEventListener(‘DOMContentLoaded’, callback)</p>
</blockquote>
<h4 id="7-1-5-移动端事件"><a href="#7-1-5-移动端事件" class="headerlink" title="7.1.5 移动端事件"></a><em>7.1.5 移动端事件</em></h4><pre><code>ontouchstart 触摸屏幕元素时触发
ontouchend 离开屏幕时触发
ontouchmove 滑动屏幕的时触发</code></pre><blockquote>
<p>某些特殊的能力，如华为手机指关节敲击屏幕可以截图、ios的3DTouch，这些特殊能力要看操作系统是不是给了浏览器权限，还要看浏览器的开发商是否开发相应功能去调用这个操作系统的能力</p>
</blockquote>
<blockquote>
<p>移动端使用onclick事件会有300ms延迟</p>
</blockquote>
<h3 id="7-2-事件对象"><a href="#7-2-事件对象" class="headerlink" title="7.2 事件对象"></a><em>7.2 事件对象</em></h3><p>事件触发时，浏览器执行事件函数并传入的一个特殊的实参，这个实参是一个对象，对象中保存了事件触发时的有效信息；一般常见的有鼠标事件对象、键盘事件对象</p>
<p>浏览器在事件触发时会执行事件函数，同时会传入一个实参对象，这个对象中包含了事件触发时的有效信息：</p>
<ul>
<li>鼠标事件对象（MouseEvent）：<ul>
<li>target <strong>触发事件的元素对象</strong>，也叫<strong>事件源</strong>；点击事件，点谁谁就是事件源；事件虽然会冒泡，但是事件源不会变；事件源是个元素对象，与操作普通元素对象一样</li>
<li>clientX 鼠标点击的位置相对于浏览器可视窗口左边的水平坐标</li>
<li>clientY 鼠标点击的位置相对于浏览器可视窗口上边的垂直坐标</li>
<li>pageX 鼠标点击的位置相对于页面左边缘的水平坐标（包含滚出的距离）</li>
<li>pageY 鼠标点击的位置相对于页面上边缘的垂直坐标（包含滚出的距离）</li>
</ul>
</li>
<li>键盘事件对象（KeyboardEvent）：<ul>
<li>keyCode 键盘上的键都有唯一与其对应的键码，键码是一个数字；常见键码：enter键 13 、ctrl键 17 、caps键 20 、空格键 32 、esc键 27 、shift键 16 、上排0-9数字 48-57 、 a-z 65-90 、左上右下 37-40<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id=<span class="string">"btn"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"class"</span>&gt;确认&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">let $ = selector =&gt; document.querySelector(selector)</span></span><br><span class="line"><span class="regexp">let btn = $('#btn')</span></span><br><span class="line"><span class="regexp">btn.onclick = function (event)&#123;</span></span><br><span class="line"><span class="regexp">	console.log(event) /</span><span class="regexp">/ MouseEvent【鼠标事件对象】</span></span><br><span class="line"><span class="regexp">	console.log(event.clientX)</span></span><br><span class="line"><span class="regexp">	console.log(event.clientY)</span></span><br><span class="line"><span class="regexp">	console.log(event.pageX)</span></span><br><span class="line"><span class="regexp">	console.log(event.pageY)</span></span><br><span class="line"><span class="regexp">	console.log(event.target)</span></span><br><span class="line"><span class="regexp">	console.log(event.target.nodeName) /</span><span class="regexp">/ 获取元素的大写标签名</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">document.onkeydown = function(event)&#123;</span></span><br><span class="line"><span class="regexp">	console.log(event) /</span><span class="regexp">/ KeyboardEvent【键盘事件对象】</span></span><br><span class="line"><span class="regexp">	console.log(event.keyCode)</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="7-3-默认事件和默认行为"><a href="#7-3-默认事件和默认行为" class="headerlink" title="7.3 默认事件和默认行为"></a><em>7.3 默认事件和默认行为</em></h3><p>例如页面中的a标签点击就可以跳转到href指向的链接、鼠标右键点击出现一个菜单、表单提交就会跳转等，这种行为称为元素的默认行为；没有给a标签绑定过事件，但点击它却有反应，这种事件称为默认事件</p>
<ul>
<li>阻止默认行为 <ul>
<li>event.preventDefault() （IE不兼容）</li>
<li>return false （通用）</li>
</ul>
</li>
<li>IE阻止默认行为 <ul>
<li>event.returnValue = false<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">"www.baidu.com"</span> id=<span class="string">"baidu"</span> target=<span class="string">"_blank"</span>&gt;&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">let baidu = document.getElementById('baidu')</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 给a标签绑定了一个点击事件</span></span><br><span class="line"><span class="regexp">baidu.onclick = function (event) &#123;</span></span><br><span class="line"><span class="regexp">	console.log('suprise!!!')</span></span><br><span class="line"><span class="regexp">	/</span><span class="regexp">/ a标签被点击的时候仍然会跳转。而'suprise!!!'也会输出出来，说明默认行为还在，绑定的事件也生效</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">	event.preventDefault() /</span><span class="regexp">/ 阻止默认行为后a标签被点击时就不会再跳转了</span></span><br><span class="line"><span class="regexp">	/</span><span class="regexp">/ return false</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">document.oncontextmenu = function (event) &#123;</span></span><br><span class="line"><span class="regexp">	event.preventDefault() /</span><span class="regexp">/ 阻止了鼠标右键的默认行为，再页面中单击鼠标右键时，系统默认的菜单不会再弹出</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="7-4-事件传播机制"><a href="#7-4-事件传播机制" class="headerlink" title="7.4 事件传播机制"></a><em>7.4 事件传播机制</em></h3><p>事件冒泡：触发某个元素的某个事件，该元素的父级元素以及整个文档顶端的document的该事件都会被依次触发；这种从低层级的html元素向高层级依次触发事件的现象称为事件的冒泡机制</p>
<blockquote>
<p>元素.onXxx = function(){} 绑定的事件都是DOM0级事件，DOM0级事件都是绑定再冒泡阶段的。</p>
</blockquote>
<blockquote>
<p>事件的触发一共有三个阶段（事件流）：捕获阶段、目标阶段、冒泡阶段</p>
</blockquote>
<pre><code>从最为外层元素找到事件源的过程称为捕获阶段，在捕获的过程中，如果经过的元素有绑定带有该事件，也会被触发，在事件目标（事件源 - 触发事件的元素对象 - event.target）点击触发后，开始向上冒泡，依次触发父级元素的该事件</code></pre><ul>
<li>取消冒泡：event.stopPropagation() 阻止事件冒泡</li>
<li>IE取消冒泡 ：event.cancelBubble = true<blockquote>
<p>取消冒泡后，事件不会再向上传播；更高层级的元素的对应事件不会触发；</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'outer'</span> <span class="attr">id</span>=<span class="string">'box'</span> <span class="attr">style</span>=<span class="string">'position: relative; margin: 30px auto; width: 500px; height: 500px; background: deeppink'</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- inner在outer里面水平垂直居中，position: absolute; 四边（上右下左）写0，margin: auto --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'inner'</span> <span class="attr">id</span>=<span class="string">'inner'</span> <span class="attr">style</span>=<span class="string">"position: absolute; top: 0; right: 0; bottom: 0; left: 0; margin: auto; width: 300px; height: 300px; background: #00b38a"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> $ = <span class="function"><span class="params">selector</span> =&gt;</span> <span class="built_in">document</span>.querySelector(selector);</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> inner = $(<span class="string">'.inner'</span>);</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> outer = $(<span class="string">'.outer'</span>);</span></span><br><span class="line"><span class="actionscript">	inner.onclick = <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'inner的click事件触发了'</span>)</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="actionscript">	outer.onclick = <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'outer的click事件触发了'</span>)</span></span><br><span class="line"><span class="actionscript">		event.stopPropagation() <span class="comment">// 阻止事件冒泡</span></span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="javascript">	<span class="built_in">document</span>.body.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'body的click事件触发了'</span>)</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="javascript">	<span class="built_in">document</span>.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(<span class="string">'document的click事件触发了'</span>)</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="7-5-enter和over的区别"><a href="#7-5-enter和over的区别" class="headerlink" title="7.5 enter和over的区别"></a><em>7.5 enter和over的区别</em></h3><p>over：从父元素进入子元素会触发父元素的离开事件；接着触发子元素的over事件，因为冒泡，又会触发父元素的over事件</p>
<p>enter：从父元素进入子元素并不会触发父元素的离开事件；接着触发子元素的enter事件，不会冒泡，所以父元素的enter事件不会触发</p>
<blockquote>
<p>如果以后项目中用到大盒子套小盒子的事情，尽量使用enter事件，减少over事件的使用（因为不可控）</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"outer"</span> id=<span class="string">"outer"</span>&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"inner"</span> id=<span class="string">"inner"</span>&gt;&lt;<span class="regexp">/div&gt;	</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line"><span class="keyword">let</span> $ = <span class="function"><span class="params">selector</span> =&gt;</span> <span class="built_in">document</span>.querySelector(selector)</span><br><span class="line"><span class="keyword">let</span> outer = $(<span class="string">'.outer'</span>)</span><br><span class="line"><span class="keyword">let</span> inner = $(<span class="string">'.inner'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// over/out使用时的效果</span></span><br><span class="line">inner.onmouseover = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'inner over'</span>);</span><br><span class="line">&#125;</span><br><span class="line">inner.onmouseout = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'inner out'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">outer.onmouseover = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'outer over'</span>);</span><br><span class="line">&#125;</span><br><span class="line">outer.onmouseout = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'outer oute'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// enter/leave使用时的效果</span></span><br><span class="line">inner.onmouseenter = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'inner enter'</span>);</span><br><span class="line">&#125;</span><br><span class="line">inner.onmouseleave = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'inner leave'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">outer.onmouseenter = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'outer enter'</span>);</span><br><span class="line">&#125;</span><br><span class="line">outer.onmouseleave = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'outer leave'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-6-onload和DOMContentLoaded"><a href="#7-6-onload和DOMContentLoaded" class="headerlink" title="7.6 onload和DOMContentLoaded"></a><em>7.6 onload和DOMContentLoaded</em></h3><ul>
<li><code>window.onload</code> 页面中所有的资源（CSS、JS、图片、字体、音视频可播放时间）全部加载完成后，才会触发</li>
<li><code>DOMContentLoaded</code> 页面中的DOM结构加载解析完成后就会触发（DOM2级事件）<blockquote>
<p>DOMContentLoaded 触发早于 window.onload</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DOM0级事件</span></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'window onload'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DOM2级事件绑定</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">// 在这里写业务逻辑，表示页面中的DOM结构加载完成后再执行这个回调函数中的代码；因为JS是用来操作DOM的，这样写是保证DOM结构加载解析完成，再操作DOM更安全</span></span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'DOM Content Loaded'</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="7-7-事件委托"><a href="#7-7-事件委托" class="headerlink" title="7.7 事件委托"></a><em>7.7 事件委托</em></h3><p>当遇到对一个元素中所有的子元素绑定相同的事件，并且事件触发时做的事情一样；利用事件的冒泡机制，把事件绑定给父元素（一般绑定给父元素，也可以绑定给更高的元素），然后根据事件触发时事件源e.target判断点击的到底是哪个元素</p>
<blockquote>
<p>事件委托的优点</p>
</blockquote>
<ul>
<li>事件委托的性能比循环绑定性能好；</li>
<li>动态添加的元素也可以有效果</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    * &#123;<span class="attribute">margin</span>: <span class="number">0</span>;<span class="attribute">padding</span>: <span class="number">0</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">ul</span>, <span class="selector-tag">li</span> &#123;<span class="attribute">list-style</span>: none;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">ul</span> &#123;<span class="attribute">margin</span>: <span class="number">30px</span> auto;<span class="attribute">width</span>: <span class="number">500px</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;<span class="attribute">height</span>: <span class="number">50px</span>;<span class="attribute">text-align</span>: center;<span class="attribute">line-height</span>: <span class="number">50px</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child(odd)</span> &#123;<span class="attribute">background</span>: <span class="number">#00b38a</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child(even)</span> &#123;<span class="attribute">background</span>: deeppink;&#125;</span></span><br><span class="line"><span class="css">	<span class="selector-id">#btn</span> &#123;<span class="attribute">width</span>: <span class="number">80px</span>; <span class="attribute">height</span>: <span class="number">40px</span>; <span class="attribute">line-height</span>: <span class="number">40px</span>&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>点击增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">	<span class="comment">/* 需求：点击页面中的每个li，输出每个li里面的内容，并且点击增加给ul新增一个li，li的内容‘item n’*/</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="comment">// for循环给每个li绑定事件</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; items.length ; i++)&#123;</span></span><br><span class="line"><span class="actionscript">		items[i].onclick = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="built_in">console</span>.log(<span class="keyword">this</span>.innerHTML)</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="actionscript">	<span class="comment">// 动态创建的li没有点击事件：因为点击增加、创建这些元素时，绑定事件的for早就执行完了，导致新建的元素没有绑定事件</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> list = <span class="built_in">document</span>.querySelector(<span class="string">'#list'</span>);</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> items = <span class="built_in">document</span>.querySelectorAll(<span class="string">'#list &gt; li'</span>);</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span></span><br><span class="line"><span class="actionscript">	btn.onclick = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">let</span> newLi = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>)</span></span><br><span class="line"><span class="javascript">		<span class="keyword">let</span> n = items.length + <span class="number">1</span></span></span><br><span class="line"><span class="javascript">		newLi.innerHTML = <span class="string">`new item <span class="subst">$&#123;n&#125;</span>`</span></span></span><br><span class="line">		list.appenChild(newLi)</span><br><span class="line">	&#125;</span><br><span class="line"><span class="actionscript">	<span class="comment">// 事件委托</span></span></span><br><span class="line"><span class="actionscript">	list.onclick = <span class="function"><span class="keyword">function</span><span class="params">(event)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(event.target.innerHTML)</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="actionscript">	<span class="comment">// 元素的点击事件一直都存在，给元素事件属性赋值为一个函数只不过是监听这个事件，当事件发生时，浏览器会把事件执行；当不给事件属性赋值一个函数时，就是没有监听这个事件，当元素被点击时，点击事件还会发生，只不过发生时不会执行你的事件函数</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="8-鼠标跟随"><a href="#8-鼠标跟随" class="headerlink" title="8. 鼠标跟随"></a><em>8. 鼠标跟随</em></h2><p>鼠标移动时，盒子要跟随鼠标，所以就是鼠标移动的过程中即onmousemove事件触发时，不断的设置盒子去鼠标的位置上，就能实现鼠标跟随。</p>
<h3 id="8-1-盒子跟随-边界判断"><a href="#8-1-盒子跟随-边界判断" class="headerlink" title="8.1 盒子跟随 + 边界判断"></a><em>8.1 盒子跟随 + 边界判断</em></h3><p>实现鼠标跟随的关键点在于计算出盒子的位置，计算位置需要鼠标在页面中的坐标位置（e.clientX / e.clientY），如果直接把clientX / clientY 当成left / top，盒子的左上角点一直跟随着鼠标；为了实现盒子的中心点跟随，需要从clientX减去半个盒子的宽，clientY减去半个盒子的高，此时把减后的值作为盒子的left和top即可实现中心跟随。</p>
<p>边界限制：不让盒子超出某个区域，控制这个盒子所在位置的是left和top的值（left、top都是相对于它的定位参照物），所以控制盒子不超过某个区域就需要限制盒子的left和top值不能小于最小值，不能大于最大值；left和top的最小值为0，再小如果为负值，就会越过左边界；left、top的最大值 = 大盒子的宽（高） - 小盒子的宽（高）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">	* &#123;<span class="attribute">margin</span>:<span class="number">0</span> ; <span class="attribute">padding</span>:<span class="number">0</span>&#125;</span></span><br><span class="line"><span class="css">	<span class="selector-class">.box</span> &#123;<span class="attribute">position</span>: absolute; <span class="attribute">background</span>: skyblue&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"box"</span> <span class="attr">style</span>=<span class="string">"width: 200px; height: 200px; left: 0; top: 0;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">	<span class="comment">/* 实现一个鼠标跟随的效果：页面中有一个盒子box，当鼠标移动的时候让盒子box跟随鼠标，并且让鼠标保持处于盒子的中心位置 */</span></span></span><br><span class="line"><span class="actionscript">	<span class="comment">// 1. 监听document的onmousemove事件</span></span></span><br><span class="line"><span class="actionscript">	<span class="comment">// 2. 实时获取鼠标的位置，把鼠标当前的位置坐标分别设置给元素的left和top</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> $ = <span class="function"><span class="params">selector</span> =&gt;</span> <span class="built_in">document</span>.querySelector(selector);</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> box = $(<span class="string">'.box'</span>);</span></span><br><span class="line"><span class="actionscript">	<span class="comment">// left和top的最小值是0</span></span></span><br><span class="line"><span class="actionscript">	<span class="comment">// left最大值 = 浏览器可视窗口的宽 - 盒子宽</span></span></span><br><span class="line"><span class="actionscript">	<span class="comment">// top最大值 = 浏览器可是窗口的高 - 盒子高</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> maxL = win(<span class="string">'clientWidth'</span>) - box.offsetWidth;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> maxT = win(<span class="string">'clientHeight'</span>) - box.offsetHeight;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> minL = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> minT = <span class="number">0</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="function"><span class="keyword">function</span> <span class="title">win</span><span class="params">(attr)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">return</span> <span class="built_in">document</span>.documentElement[attr] || <span class="built_in">document</span>.body[attr]</span></span><br><span class="line">	&#125; </span><br><span class="line"></span><br><span class="line"><span class="javascript">	<span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// console.log(e.clientX, e.clientY)</span></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 为了让鼠标处于盒子的中心位置，因为元素在跟着鼠标动，鼠标的位置是不能改的，为了让鼠标在盒子中心位置，所以需要让 clientX 减去 半个盒子的宽，clientY - 半个盒子的高</span></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// box.style.left = e.clientX - parseFloat(box.style.width) / 2 + 'px'</span></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// box.style.top = e.clientY - parseFloat(box.style.height) / 2 + 'px'</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">		<span class="comment">// 边界限制</span></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 原理：用户看到的是盒子不能超过浏览器窗口，事实上是left和top不能超过某个值；</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">		<span class="comment">// 1. 根据鼠标的位置计算盒子的left和top</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">let</span> left = e.clientX - box.offsetWidth / <span class="number">2</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">let</span> top = e.clientY - box.offsetHeight / <span class="number">2</span>;	</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 2. 判断是否越界，如果越界就需要去修正（比最大值还大就等于最大值，比最小值还小就等于最小值）</span></span></span><br><span class="line"><span class="actionscript">		left &lt; minL ? left = minL : <span class="literal">null</span></span></span><br><span class="line"><span class="actionscript">		left &gt; maxL ? left = maxL : <span class="literal">null</span></span></span><br><span class="line"><span class="actionscript">	  top &lt; minT ? top = minT : <span class="literal">null</span></span></span><br><span class="line"><span class="actionscript">		top &gt; maxT ? top = maxT : <span class="literal">null</span>	</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 3. 把left和top设置给元素</span></span></span><br><span class="line"><span class="actionscript">		box.style.left = left + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">  	box.style.top = top + <span class="string">'px'</span>;</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2-简单的自定义菜单"><a href="#8-2-简单的自定义菜单" class="headerlink" title="8.2 简单的自定义菜单"></a><em>8.2 简单的自定义菜单</em></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">	* &#123; <span class="attribute">margin</span>: <span class="number">0</span>; <span class="attribute">padding</span>: <span class="number">0</span>; &#125;</span></span><br><span class="line"><span class="css">	<span class="selector-tag">ul</span>, <span class="selector-tag">li</span> &#123; <span class="attribute">list-style</span>: none; &#125;</span></span><br><span class="line"><span class="css">	<span class="selector-tag">ul</span> &#123; <span class="attribute">position</span>: absolute; <span class="attribute">width</span>: <span class="number">200px</span>; <span class="attribute">border</span>: <span class="number">1px</span> solid skyblue; &#125;</span></span><br><span class="line"><span class="css">	<span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123; <span class="attribute">height</span>: <span class="number">50px</span>; <span class="attribute">text-align</span>: center; <span class="attribute">line-height</span>: <span class="number">50px</span>; <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#000</span>; <span class="attribute">font-size</span>: <span class="number">20px</span>; &#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span>    </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"menu"</span> <span class="attr">style</span>=<span class="string">"left: 0; top: 0; display: none;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">"refresh"</span>&gt;</span>刷新<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">"百度"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://www.baidu.com"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>function 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>function 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>function 5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 0. 去掉默认菜单</span></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 1. 获取鼠标的位置</span></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 2. 把ul的left和top设置为鼠标的位置</span></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 3. 把盒子的display属性设为block</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> $ = <span class="function"><span class="params">selector</span> =&gt;</span> <span class="built_in">document</span>.querySelector(selector);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> menu = $(<span class="string">'#menu'</span>);</span></span><br><span class="line">    </span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">win</span><span class="params">(attr)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="built_in">document</span>.documentElement[attr] || <span class="built_in">document</span>.body[attr]</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.oncontextmenu = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line">        e.preventDefault()</span><br><span class="line"><span class="actionscript">        <span class="comment">// 1. </span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// console.log(e.clientX, e.clientX)</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> left = e.clientX + <span class="string">'px'</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> top = e.clientY + <span class="string">'px'</span></span></span><br><span class="line">        menu.style.left = left</span><br><span class="line">        menu.style.top = top </span><br><span class="line"><span class="actionscript">        menu.style.display = <span class="string">'block'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">if</span>(menu.style.display = <span class="string">'block'</span>)&#123;</span></span><br><span class="line"><span class="actionscript">            menu.style.display = <span class="string">'none'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> refresh = $(<span class="string">'#refresh'</span>);</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 增加刷新功能</span></span></span><br><span class="line"><span class="actionscript">    refresh.onclick = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 方法1：reload</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location.reload()</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 方法2：重新给location的href属性赋值</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// window.location.href获取当前页面的url，如果给href属性赋值一个url，页面就会跳转到这个url指向的页面</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location.href = <span class="built_in">window</span>.location.href</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="comment">/* 实现一个和原生菜单类似的功能，如果距离底部太小，盒子就要在鼠标上面出现；如果距离页面顶部太小，就要在鼠标下面出现 */</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-3-放大镜"><a href="#8-3-放大镜" class="headerlink" title="8.3 放大镜"></a><em>8.3 放大镜</em></h3><blockquote>
<p>PRD：实现一个电商放大镜的效果（放大三倍）</p>
</blockquote>
<ul>
<li>1.默认只展示原图</li>
<li>2.当鼠标移入原图盒子时，原图盒子中的遮罩层及装大图的盒子都要出现</li>
<li>3.当鼠标在原图盒子中移动时，遮罩层要跟随鼠标一起移动，但是盒子不能超出原图的盒子边界（带边界限制的鼠标跟随）</li>
<li>4.大图盒子内所展示的部分跟遮罩层部分相同（正好是遮罩层盖住的原图部分）</li>
<li>5.遮罩层和大图的运动方向相反，遮罩层在原图盒子中移动距离x，大图就需要移动-3x的距离</li>
<li>6.当鼠标划（移）出原图时，遮罩层和大图都要消失</li>
</ul>
<blockquote>
<p>原理：利用 遮罩层 ：原图 = 大图盒子 ：大图片</p>
</blockquote>
<blockquote>
<p>思路：放大镜放大三倍</p>
</blockquote>
<ul>
<li>1.页面当中有两个盒子，一个是用来装原图的box1，另一个是用来装大图的box2；box1和box2的尺寸（宽高）是相等的</li>
<li>2.box1下面有一个遮罩层mask，这个遮罩层盖住的box1的部分和box2露出的大图部分是相同的，所以有一个比例关系：mask的宽高 / box1的宽高 = box2 / 大图片的尺寸</li>
<li>3.mask相对于box1绝对定位（position:absolute），大图片相对于box2绝对定位</li>
<li>4.监听box1的划入（onmouseenter）事件，当事件触发时，设置mask和box2的display:block</li>
<li>5.鼠标进入box1时，mask需要跟随鼠标，所以要监听box1的鼠标滑动（onmousemove）事件，在事件函数中实现鼠标带边界的中心跟随</li>
<li>6.当mask在box1中移动x距离的时候，大图片bigImg要向相反的方向移动3x距离（相当于移动-3x距离）</li>
<li>7.当鼠标移出box1的时候，mask和box2消失，所以需要监听box1的鼠标移出（onmouseleave）事件，在事件中把mask和box2的display设置为none<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    * &#123;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line"><span class="css">        <span class="comment">/* 给box清除浮动 */</span></span></span><br><span class="line">        overflow: hidden;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.box1</span>, <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line">        margin: 30px;</span><br><span class="line"><span class="css">        <span class="comment">/* 相对定位不会脱离文档流 */</span></span></span><br><span class="line">        position: relative;</span><br><span class="line">        float: left;</span><br><span class="line">        width: 300px;</span><br><span class="line">        height: 300px;</span><br><span class="line">        border: 1px solid red;</span><br><span class="line">        overflow: hidden;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.box1</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.mask</span> &#123;</span></span><br><span class="line">        position: absolute;</span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(59, 53, 53, 0<span class="selector-class">.5</span>);</span></span><br><span class="line"><span class="css">        <span class="comment">/* cursor: pointer 小手指 ; not-allowed 禁止 ; move 十字，表示移动 */</span></span></span><br><span class="line">        cursor: move;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line">        display: none;</span><br><span class="line">    &#125; </span><br><span class="line"><span class="css">    <span class="selector-class">.box2</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line">		position: absolute;</span><br><span class="line">        width: 900px;</span><br><span class="line">        height: 900px;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span> <span class="attr">id</span>=<span class="string">"box1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"iphone.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mask"</span> <span class="attr">id</span>=<span class="string">"mask"</span> <span class="attr">style</span>=<span class="string">"width: 100px; height: 100px; left: 0; top: 0; display: none;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span> <span class="attr">id</span>=<span class="string">"box2"</span> <span class="attr">class</span>=<span class="string">"display: none;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"iphone.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"bigImg"</span> <span class="attr">id</span>=<span class="string">"bigImg"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 1. 获取元素</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> $ = <span class="function"><span class="params">selector</span> =&gt;</span> <span class="built_in">document</span>.querySelector(selector);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> box1 = $(<span class="string">'.box1'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> mask = $(<span class="string">'.mask'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> box2 = $(<span class="string">'.box2'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> bigImg = $(<span class="string">'.bigImg'</span>);</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 2. 监听box1的进入和移出，让mask和box消失隐藏</span></span></span><br><span class="line"><span class="actionscript">    box1.onmouseenter = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        mask.style.display = box2.style.display = <span class="string">'block'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    box1.onmouseleave = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        mask.style.display = box2.style.display = <span class="string">'none'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 3. 实现在box1中移动鼠标mask中心有边界跟随，并且bigImg相应移动</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 这些都是mask移动边界值</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> minL = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> minT = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> maxL = box1.clientWidth - <span class="built_in">parseFloat</span>(mask.style.width);</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> maxT = box1.clientHeight - <span class="built_in">parseFloat</span>(mask.style.height);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    box1.onmousemove = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 3.1 获取鼠标的位置</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">let</span> left = e.clientX - box1.offsetLeft - <span class="built_in">parseFloat</span>(mask.style.width) / <span class="number">2</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">let</span> top = e.clientY - box1.offsetTop - <span class="built_in">parseFloat</span>(mask.style.height) / <span class="number">2</span></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 3.2 对鼠标位置进行修正</span></span></span><br><span class="line"><span class="actionscript">		left &lt; minL ? left = minL : <span class="literal">null</span>;</span></span><br><span class="line"><span class="actionscript">		left &gt; maxL ? left = maxL : <span class="literal">null</span>;</span></span><br><span class="line"><span class="actionscript">		top &lt; minT ? top = minT : <span class="literal">null</span>;</span></span><br><span class="line"><span class="actionscript">		top &gt; maxT ? top = maxT : <span class="literal">null</span>;</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 3.3 把修正后的值设置给元素、bigImg</span></span></span><br><span class="line"><span class="actionscript">        mask.style.left = left + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        mask.style.top = top + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 3.4 按照放大比例，设置bigImg的left和top</span></span></span><br><span class="line"><span class="actionscript">        bigImg.style.left = <span class="number">-3</span> * left + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        bigImg.style.top = <span class="number">-3</span> * top + <span class="string">'px'</span>;</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<!-- flag of hidden posts --></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:edsyang1102@gmail.com">Edsyang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://blog.lagerstroemia.com.cn/2019/07/20/course/origin/08-Chapter%20Six-B.part%20two/">http://blog.lagerstroemia.com.cn/2019/07/20/course/origin/08-Chapter%20Six-B.part%20two/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.lagerstroemia.com.cn" target="_blank">Edsyang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JS-Notes/">JS Notes</a></div><div class="post_share"><div class="social-share" data-image="https://tva1.sinaimg.cn/large/0081Kckwly1gkrf2rz04kj30m00ffq3z.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.png" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'WgFk4Onl7sisfXpq9vHcehGJ-gzGzoHsz',
  appKey: '3DLR7iLY5al5dbIdo9kWnDHU',
  notify: false,
  verify: false,
  placeholder: 'Please leave your footprints',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'en',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: true,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Edsyang</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.miit.gov.cn/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>冀ICP备19038398号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/search/local-search.js"></script></body></html>