<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>React - Chapter One.E | Edsyang</title><meta name="robots" content="noindex"><meta name="description" content="18. 组合在 React 中也可以获取组件标签包裹的内容；类似于 Vue 的 slot 机制，在 React 中这种机制称为组合  除了获取标签中包裹的内容，还可以把指定的内容放在指定的位置，也是通过 props 来实现  17.1 获取组件标签包裹的内容 - 通过 props.childrencomponents&#x2F;Panel.js：使用 Panel 组件，并在其中嵌入内容 1234567891"><meta name="keywords" content="JS Notes"><meta name="author" content="Edsyang,edsyang1102@gmail.com"><meta name="copyright" content="Edsyang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.svg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="React - Chapter One.E"><meta name="twitter:description" content="18. 组合在 React 中也可以获取组件标签包裹的内容；类似于 Vue 的 slot 机制，在 React 中这种机制称为组合  除了获取标签中包裹的内容，还可以把指定的内容放在指定的位置，也是通过 props 来实现  17.1 获取组件标签包裹的内容 - 通过 props.childrencomponents&#x2F;Panel.js：使用 Panel 组件，并在其中嵌入内容 1234567891"><meta name="twitter:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gegal5ikmoj30u00xpe81.jpg"><meta property="og:type" content="article"><meta property="og:title" content="React - Chapter One.E"><meta property="og:url" content="http://blog.lagerstroemia.com.cn/2019/09/01/course/react/14-React.js-E.part%20five/"><meta property="og:site_name" content="Edsyang"><meta property="og:description" content="18. 组合在 React 中也可以获取组件标签包裹的内容；类似于 Vue 的 slot 机制，在 React 中这种机制称为组合  除了获取标签中包裹的内容，还可以把指定的内容放在指定的位置，也是通过 props 来实现  17.1 获取组件标签包裹的内容 - 通过 props.childrencomponents&#x2F;Panel.js：使用 Panel 组件，并在其中嵌入内容 1234567891"><meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gegal5ikmoj30u00xpe81.jpg"><meta property="article:published_time" content="2019-09-01T02:14:03.314Z"><meta property="article:modified_time" content="2020-05-18T16:05:53.204Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://blog.lagerstroemia.com.cn/2019/09/01/course/react/14-React.js-E.part%20five/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: Edsyang","link":"链接: ","source":"来源: Edsyang","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Edsyang" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">124</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">44</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#18-组合"><span class="toc-number">1.</span> <span class="toc-text">18. 组合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#17-1-获取组件标签包裹的内容-通过-props-children"><span class="toc-number">1.1.</span> <span class="toc-text">17.1 获取组件标签包裹的内容 - 通过 props.children</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-把指定内容插入到指定位置-通过-props-属性名"><span class="toc-number">1.2.</span> <span class="toc-text">17.2 把指定内容插入到指定位置 - 通过 props.属性名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-Context"><span class="toc-number">2.</span> <span class="toc-text">19. Context</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#19-1-context-用法（API）"><span class="toc-number">2.1.</span> <span class="toc-text">19.1 context 用法（API）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-React-createContext-defaultValue"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. React.createContext(defaultValue)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-lt-Context-Provider-gt"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. &lt;Context.Provider&gt;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Class-contextType"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. Class.contextType</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-lt-Context-Consumer-gt"><span class="toc-number">2.1.4.</span> <span class="toc-text">4. &lt;Context.Consumer&gt;</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-2-使用-Context-改写上述例子"><span class="toc-number">2.2.</span> <span class="toc-text">19.2 使用 Context 改写上述例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-高阶组件（HOC-HigherOrderComponent）"><span class="toc-number">3.</span> <span class="toc-text">20. 高阶组件（HOC - HigherOrderComponent）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-React-router"><span class="toc-number">4.</span> <span class="toc-text">21. React-router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#20-1-安装路由"><span class="toc-number">4.1.</span> <span class="toc-text">20.1 安装路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-2-基本使用"><span class="toc-number">4.2.</span> <span class="toc-text">20.2 基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#跑通基本路由"><span class="toc-number">4.2.1.</span> <span class="toc-text">跑通基本路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#路由的匹配规则"><span class="toc-number">4.2.2.</span> <span class="toc-text">路由的匹配规则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-3-Link-组件"><span class="toc-number">4.3.</span> <span class="toc-text">20.3 Link 组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-4-嵌套路由（二级路由）"><span class="toc-number">4.4.</span> <span class="toc-text">20.4 嵌套路由（二级路由）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-5-编程式导航"><span class="toc-number">4.5.</span> <span class="toc-text">20.5 编程式导航</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-6-动态路由"><span class="toc-number">4.6.</span> <span class="toc-text">20.6 动态路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-7-路由匹配-exact、render、Switch组件"><span class="toc-number">4.7.</span> <span class="toc-text">20.7 路由匹配 - exact、render、Switch组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-8-受保护的路由-导航守卫-Redirect-组件"><span class="toc-number">4.8.</span> <span class="toc-text">20.8 受保护的路由(导航守卫) - Redirect 组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-9-自定义菜单-amp-NavLink组件"><span class="toc-number">4.9.</span> <span class="toc-text">20.9 自定义菜单&amp;NavLink组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-10-Prompt-组件"><span class="toc-number">4.10.</span> <span class="toc-text">20.10 Prompt 组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-11-NotFound-页面"><span class="toc-number">4.11.</span> <span class="toc-text">20.11 NotFound 页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-12-React-router-练习"><span class="toc-number">4.12.</span> <span class="toc-text">20.12 React-router 练习</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://tva1.sinaimg.cn/large/007S8ZIlly1gegal5ikmoj30u00xpe81.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Edsyang</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">React - Chapter One.E</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-09-01 02:14:03"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-09-01</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-05-18 16:05:53"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-05-18</span></time></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">7.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 33 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="18-组合"><a href="#18-组合" class="headerlink" title="18. 组合"></a><em>18. 组合</em></h2><p>在 React 中也可以获取组件标签包裹的内容；类似于 Vue 的 slot 机制，在 React 中这种机制称为<strong>组合</strong></p>
<blockquote>
<p>除了获取标签中包裹的内容，还可以把指定的内容放在指定的位置，也是通过 props 来实现</p>
</blockquote>
<h3 id="17-1-获取组件标签包裹的内容-通过-props-children"><a href="#17-1-获取组件标签包裹的内容-通过-props-children" class="headerlink" title="17.1 获取组件标签包裹的内容 - 通过 props.children"></a><em>17.1 获取组件标签包裹的内容 - 通过 <code>props.children</code></em></h3><p>components/Panel.js：使用 Panel 组件，并在其中嵌入内容</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Panel</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;panel</span> <span class="attr">panel-success</span>&#125;&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;</span></span><br><span class="line"><span class="xml">        // 可以通过 props.children 属性来获取当前组件标签包裹的内容</span></span><br><span class="line"><span class="xml">        this.props.children</span></span><br><span class="line"><span class="xml">      &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Panel</span><br></pre></td></tr></table></figure>
<p>App.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.min.css'</span></span><br><span class="line"><span class="keyword">import</span> Panel <span class="keyword">from</span> <span class="string">'./components/Panel'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"App"</span>&gt;</span></span></span><br><span class="line">    &lt;Panel&gt;</span><br><span class="line">      &lt;h1&gt;this is a panel&lt;/h1&gt;</span><br><span class="line">      &lt;p&gt;this is a tag p&lt;/p&gt;</span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">Panel</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<h3 id="17-2-把指定内容插入到指定位置-通过-props-属性名"><a href="#17-2-把指定内容插入到指定位置-通过-props-属性名" class="headerlink" title="17.2 把指定内容插入到指定位置 - 通过 props.属性名"></a><em>17.2 把指定内容插入到指定位置 - 通过 <code>props.属性名</code></em></h3><blockquote>
<p>改造 Panel，要求 head、body、footer的内容通过父组件指定</p>
</blockquote>
<p>components/Panel.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Panel</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;panel</span> <span class="attr">panel-success</span>&#125;&gt;</span></span></span><br><span class="line">            &lt;div className=&#123;panel panel-header&#125;&gt;</span><br><span class="line">                &#123; this.props.head &#125;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;div className=&#123;panel panel-body&#125;&gt;</span><br><span class="line">                &#123; this.props.body &#125;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;div className=&#123;panel panel-footer&#125;&gt;</span><br><span class="line">                &#123; this.props.footer &#125;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Panel</span><br></pre></td></tr></table></figure>
<p>App.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.min.css'</span></span><br><span class="line"><span class="keyword">import</span> Panel <span class="keyword">from</span> <span class="string">'./components/Panel'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> head = <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>this is Heading<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    <span class="keyword">let</span> body = <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>this is text theme<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    <span class="keyword">let</span> footer = (<span class="xml"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">'btn btn-danger'</span>&gt;</span>remove<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">'btn btn-success'</span>&gt;</span>add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span>)</span><br><span class="line">    <span class="comment">// 还可以通过和下面的 &lt;Panel &#123;...slot&#125;/&gt; 结合的方式</span></span><br><span class="line">    <span class="keyword">let</span> slot = &#123;</span><br><span class="line">        head,</span><br><span class="line">        body,</span><br><span class="line">        footer</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"App"</span>&gt;</span></span></span><br><span class="line">        &lt;Panel head=&#123;header&#125;</span><br><span class="line">               body=&#123;body&#125;</span><br><span class="line"><span class="xml">               footer=&#123;footer&#125;/&gt;</span></span><br><span class="line"><span class="xml">        &#123;/* 还可以通过和上面的 let slot = ... 结合的方式 */&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">Panel</span> &#123;<span class="attr">...slot</span>&#125;/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<h2 id="19-Context"><a href="#19-Context" class="headerlink" title="19. Context"></a><em>19. Context</em></h2><p>Context 提供了一个无需为每层组件手动添加 props，就能在组件树间进行数据传递的方法。</p>
<blockquote>
<p>目的：为了共享那些对于一个组件树而言是“全局”的数据，例如当前认证的用户、主题或首选语言</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 举一个例子，现在有 ThemeButton 组件、Toolbar组件、App 组件；App 组件需要指定一个主体色，App 中有一个 Toolbar，Toolbar 中有一个 ThemeButton，ThemeButton 则会根据主题色显示不同的颜色；所以这个主题色 theme prop 将会从 App 传递给 Toolbar ，然后再由 Toolbar 传递给 ThemeButton</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThemeButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">btn</span> <span class="attr">btn-</span>$&#123;<span class="attr">this.props.theme</span>&#125;`&#125;&gt;</span>确定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Toolbar</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeButton</span> <span class="attr">theme</span>=<span class="string">&#123;this.props.theme&#125;/</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Toolbar</span> <span class="attr">theme</span>=<span class="string">'success'</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这样如果层级再深一些，传递起来很繁琐，为了解决这个问题我们需要使用 Context</p>
</blockquote>
<h3 id="19-1-context-用法（API）"><a href="#19-1-context-用法（API）" class="headerlink" title="19.1 context 用法（API）"></a><em>19.1 context 用法（API）</em></h3><p>Context 提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树逐层传递 props</p>
<h4 id="1-React-createContext-defaultValue"><a href="#1-React-createContext-defaultValue" class="headerlink" title="1. React.createContext(defaultValue)"></a><em>1. React.createContext(defaultValue)</em></h4><ul>
<li>创建一个 context 对象，当 React 渲染一个订阅了这个 Context 对象的组件，这个组件会从组件树中离自身最近的那个匹配的 Provider 中读取到当前的 context 值。<blockquote>
<p>为了让更多的组件拿到 context 共享的值，一般把 Context 在一个单独的 js 文件中创建并导出，然后在用的组件中导入（用法有点像 Vue 中的 eventBus 事件总线）；并且 Context.Provider 在组件树中的层级要放得尽可能的高（比如放到 App.js）</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myContext = React.createContext(defaultValue) <span class="comment">// defaultValue 是默认值（形式：&#123;theme: 'dark'&#125; 或者 'dark' ...），只有当组件所处的组件树中没有匹配到 Provider 时，defaultValue 才会生效</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-lt-Context-Provider-gt"><a href="#2-lt-Context-Provider-gt" class="headerlink" title="2. &lt;Context.Provider&gt;"></a><em>2. &lt;Context.Provider&gt;</em></h4><ul>
<li>通过 <code>Context.Provider</code> 组件，把当前 Context 要共享的数据引入到组件树中</li>
<li>Provider 接受一个 <code>value</code> 属性，传递给使用 Context 的组件，一个 Provider 可以被多个组件使用，当 Provider 中的 value 发生变化时，使用该 Provider 的组件都会重新渲染<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;myContext.Provider value=&#123;<span class="comment">/* 某个值 */</span>&gt;&#125;/&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="3-Class-contextType"><a href="#3-Class-contextType" class="headerlink" title="3. Class.contextType"></a><em>3. Class.contextType</em></h4><ul>
<li>在 class 声明的组件内，如果下层组件使用上面 Provider 提供的 value 需要在组件中使用 static（静态属性）来初始化 contextType，属性值是要取值的 Context；然后在组件中（除了 constructor）可以通过 this.context 获取 Provider 的 value 属性指定的共享的值</li>
<li>如果在 constructor 中使用 context，constructor 的第二个参数就是 context 的值</li>
<li>给组件设置 contextType 属性以后，在这个组件中除了 constructor 以外任意的地方可以通过 this.context 获取离当前组件最近的 <code>&lt;Context.Provider&gt;</code> 共享的 value；而在构造函数（constructor）中，第二个参数就是 context 的值；如果当前组件在组件树中没有找到当前 Context 的 Provider 共享的 value，则使用当前 Context 的默认值<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> contextType = MyContext;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="keyword">this</span>.context;</span><br><span class="line">    <span class="comment">/* 基于这个值进行渲染工作 */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">    <span class="comment">// 在 constructor 中 context 通过第二个形参取值</span></span><br><span class="line">    <span class="comment">// 在除了 constructor 以外的地方，通过 this.context 取值</span></span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="keyword">this</span>.context;</span><br><span class="line">    <span class="comment">/* 在组件挂载完成后，使用 MyContext 组件的值来执行一些有副作用的操作 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="keyword">this</span>.context;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="keyword">this</span>.context;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="keyword">this</span>.context;</span><br><span class="line">    <span class="comment">/* 基于 MyContext 组件的值进行渲染 */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">MyClass.contextType = MyContext;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="4-lt-Context-Consumer-gt"><a href="#4-lt-Context-Consumer-gt" class="headerlink" title="4. &lt;Context.Consumer&gt;"></a><em>4. &lt;Context.Consumer&gt;</em></h4><ul>
<li>在函数式声明的组件中使用 Context 共享的值需要使用 Consumer 组件（在函数式组件中完成订阅 context），即 Context.Consumer；要求 Consumer 的子节点是一个函数，函数的形参 value 就是当前 Context 共享的值</li>
<li>需要函数作为子元素（function as a child）这种做法。这个函数接收当前的 context 值，返回一个 React 节点。传递给函数的 value 值等同于往上组件树离这个 context 最近的 Provider 提供的 value 值。如果没有对应的 Provider，value 参数等同于传递给 createContext() 的 defaultValue。<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;MyContext.Consumer&gt;</span><br><span class="line">  &#123;value =&gt; <span class="comment">/* 基于 context 值进行渲染*/</span>&#125;</span><br><span class="line">&lt;<span class="regexp">/MyContext.Consumer&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="19-2-使用-Context-改写上述例子"><a href="#19-2-使用-Context-改写上述例子" class="headerlink" title="19.2 使用 Context 改写上述例子"></a><em>19.2 使用 Context 改写上述例子</em></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Context 提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建 context</span></span><br><span class="line"><span class="keyword">let</span> ThemeContext = React.createContext(<span class="string">'success'</span>) <span class="comment">// React.createContext(defaultValue) 创建一个 Context，defaultValue 是默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 通过 Context.Provider 这个组件把当前 Context 共享的数据引入到组件树中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. class 声明使用 contextType：</span></span><br><span class="line"><span class="comment">// class ThemeButton extends React.Component &#123;</span></span><br><span class="line"><span class="comment">//   static contextType = ThemeContext</span></span><br><span class="line"><span class="comment">//   constructor(props, context) &#123;</span></span><br><span class="line"><span class="comment">//     super()</span></span><br><span class="line"><span class="comment">//     console.log(context);</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   render() &#123;</span></span><br><span class="line"><span class="comment">//     return &lt;button className=&#123;`btn btn-$&#123;this.context&#125;`&#125;&gt;充值&lt;/button&gt;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 如果是函数式声明的组件，需要使用 Context.Consumer 组件</span></span><br><span class="line"><span class="comment">// 函数式声明 ThemeButton</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ThemeButton</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="xml">    &#123;</span></span><br><span class="line"><span class="xml">      // Context.Consumer 组件的子节点需要一个函数，这个函数的参数就是 Context 共享的数据</span></span><br><span class="line"><span class="xml">      value =&gt; <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">btn</span> <span class="attr">btn-</span>$&#123;<span class="attr">value</span>&#125;`&#125;&gt;</span>&#123; value&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">ThemeContext.Consumer</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Toolbar</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeButton</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// Context.Provider 可以把 value 的值引入到组件中，Provider 下面的组件都可以通过 context 获取到他共享的数据</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">'success'</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Toolbar</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<h2 id="20-高阶组件（HOC-HigherOrderComponent）"><a href="#20-高阶组件（HOC-HigherOrderComponent）" class="headerlink" title="20. 高阶组件（HOC - HigherOrderComponent）"></a><em>20. 高阶组件（HOC - HigherOrderComponent）</em></h2><p>高阶组件：是 React 中用于复用组件逻辑的一种高级技巧，是一种基于 React 的组合特性而形成的设计模式（就像是一个工厂模式）</p>
<ul>
<li>高阶组件：参数接收一个组件，返回值为一个新组件的函数。</li>
<li>高阶函数：箭头大于一个的函数就是高阶函数，例如：<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> connect = <span class="function"><span class="params">()</span> =&gt;</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
本地有两个组件，Username 和 Password；Username 的作用是从 localStorage 中读取 username 属性，并且展示到 input 中；Password 组件作用类似，不同的是它展示的是从 localStorage 中读取的 password 字段；</li>
</ul>
<p>components/Username.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Username</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      username: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillMount () &#123;</span><br><span class="line">    <span class="keyword">let</span> val = localStorage.getItem(<span class="string">'username'</span>)</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      username: val</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span></span><br><span class="line"><span class="xml">                  value=&#123;this.state.username</span></span><br><span class="line"><span class="xml">                  onChange=&#123;() =&gt; &#123;&#125;&#125;&#125;/&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Username</span><br></pre></td></tr></table></figure>
<p>components/Password.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Password</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      password: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillMount () &#123;</span><br><span class="line">    <span class="keyword">let</span> val = localStorage.getItem(<span class="string">'password'</span>)</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      password: val</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span></span><br><span class="line"><span class="xml">                  value=&#123;this.state.password&#125;</span></span><br><span class="line"><span class="xml">                  onChange=&#123;() =&gt; &#123;&#125;&#125;&#125;/&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Password</span><br></pre></td></tr></table></figure>
<blockquote>
<p>组件中很多代码功能都是相同的，此时我们可以把在抽象成一个高阶组件，把不同的部分当成参数：如上面的从 localStorage 中获取的字段名不同，最终需要的组件不同；</p>
</blockquote>
<p>components/Local.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">let</span> local = <span class="function">(<span class="params">key</span>) =&gt;</span> <span class="function">(<span class="params">Component</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">HOCProxy</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">      <span class="keyword">constructor</span>() &#123;</span><br><span class="line">          <span class="keyword">super</span>()</span><br><span class="line">          <span class="keyword">this</span>.state = &#123;</span><br><span class="line">              [key]: <span class="string">''</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      componentWillMount() &#123;</span><br><span class="line">          <span class="keyword">let</span> val = localStorage.getItem(key)</span><br><span class="line">          <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">              [key]: val</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      render() &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...this.state</span>&#125; /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> local</span><br></pre></td></tr></table></figure>

<p><strong>改造 Username.js 和 Password.js</strong></p>
<p>components/Username.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> local <span class="keyword">from</span> <span class="string">'./local'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Username</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;input type="text"</span><br><span class="line">                   value=&#123;this.props.username&#125;</span><br><span class="line"><span class="xml">                   onChange=&#123;() =&gt; &#123;&#125;&#125;/&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> local(<span class="string">'username'</span>)(Username)</span><br></pre></td></tr></table></figure>
<p>components/Password.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> local <span class="keyword">from</span> <span class="string">'./local'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Password</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;input type="text"</span><br><span class="line">                   value=&#123;this.props.password&#125;</span><br><span class="line"><span class="xml">                   onChange=&#123;() =&gt; &#123;&#125;&#125; /&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> local(<span class="string">'password'</span>)(Password)</span><br></pre></td></tr></table></figure>

<h2 id="21-React-router"><a href="#21-React-router" class="headerlink" title="21. React-router"></a><em>21. React-router</em></h2><p><a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener">https://reacttraining.com/react-router/</a></p>
<p><strong>该 ReactRouter 中所提到的 API :</strong></p>
<ul>
<li><code>&lt;BrowserRouter&gt;</code> 使用 HTML5 history API，使组件同步 url，路径没有 #，需要配合后台使用</li>
<li><code>&lt;HashRouter&gt;</code> 通过 hash 来保持组件与 url 同步，路径带有 #</li>
<li><code>&lt;MemoryRouter&gt;</code> 在内存中管理路由（history），地址栏不发生变化，在测试/非浏览器环境（如 React Native）中使用</li>
<li><code>&lt;Route&gt;</code> ReactRouter 中最重要的组件，基本职责是在 location 和 Route 的 path 匹配时渲染 component 对应的组件<ul>
<li>Route 渲染方法（用以下方法呈现内容 <code>&lt;Route&gt;</code>）：<code>&lt;Route component&gt; &lt;Route render&gt; &lt;Route children&gt;</code>；都是当页面 url 中的路径和 Route 的 path 匹配的时候执行；大部分情况下用 component</li>
<li>Route 属性（props）（三种渲染方法都会传递三个相同的属性）：match location history</li>
<li><code>&lt;Route path=&#39;&#39;&gt;</code>：任何有效的路径</li>
<li><code>&lt;Route exact&gt;</code>：精确匹配</li>
<li><code>&lt;Route component={ 组件名 }&gt;</code>：值是对应的组件名；根据路径是否匹配决定是否渲染传递过来的组件</li>
<li><code>&lt;Route render={(props) =&gt; {}}&gt;</code>：（多用于权限验证）当页面中的值是函数，这个函数需要返回一个 jsx 或者一个组件；render 会把该 jsx 或者组件渲染到页面中，充当的是一个组件的作用；组件是否渲染不仅要看路径是否匹配，还要由render属性所接受的函数来共同决定；render 接受一个参数 props，即当前 Route 组件的 props 对象</li>
<li><code>&lt;Route children={(props) =&gt; {}}&gt;</code>：（多用于菜单）和 render 功能一样，但是不论路由路径是否匹配都会执行 children 这个回调函数<blockquote>
<p>注意：<code>&lt;Route component&gt;</code> 优先于 <code>&lt;Route render&gt;</code>，所以不要同时使用两者</p>
</blockquote>
</li>
</ul>
</li>
<li><code>&lt;Link&gt;</code> 为程序提供一个可访问的导航（跳转 url）<ul>
<li><code>&lt;Link to&gt;</code>：点击时把页面中 url 的路径切换到 to 属性所指的路径；属性值可以是字符串也可以是对象</li>
</ul>
</li>
<li><code>&lt;NavLink&gt;</code> <code>&lt;Link&gt;</code> 的一个特殊版本，当它匹配当前URL时，将向 render 的元素添加样式属性</li>
<li><code>&lt;Redirect&gt;</code> 重定向，类似于导航守卫的作用，当不符合判定要求时，将 url 重定向到指定的位置<ul>
<li><code>&lt;Redirect to&gt;</code> 重定向至指定的路径；属性值可以是字符串也可以是对象</li>
</ul>
</li>
<li><code>&lt;Switch&gt;</code> 只会渲染一条模糊匹配的 <code>&lt;Route&gt;</code> 或者 <code>&lt;Redirect&gt;</code></li>
<li><code>&lt;Prompt&gt;</code> 跳转至其他 url 且尚未保存当前 url 中的操作时的提示<ul>
<li><code>&lt;Prompt when&gt;</code>：返回一个布尔值，为 true 时提醒，false 时不提醒</li>
<li><code>&lt;Prompt message&gt;</code>：提醒的信息；可以是字符串也可以是一个函数</li>
</ul>
</li>
<li>history 指 history 包，是 ReactRouter 的两个主要依赖之一，在各种环境中管理 js 中的会话历史；会根据不用的容器组件（HashRoute等）生成不同的 history<ul>
<li>history.push(path, state) 用代码切换路由（编程式导航），path 就是要切换的路由</li>
<li>history.go(n)  将 history 堆栈中的指针向前移动 n</li>
<li>history.block(prompt) 阻止跳转</li>
</ul>
</li>
<li>match 包含有关 Route path 如何匹配 url 的信息<ul>
<li>match.params 获取动态路由的参数</li>
<li>match.url 获取 url 的匹配部分</li>
<li>match.path 用于 match 的路径模式，用于构建嵌套路由</li>
</ul>
</li>
<li>location 当前访问地址信息组成的对象（代表应用程序的位置）<ul>
<li>location.pathname URL 的路径</li>
<li>location.search URL 查询字符串</li>
<li>location.hash URL 的 hash 片段</li>
<li>location.state 特定位置的状态，当该位置被推入堆栈时，该状态被提供给例如 push(path, state) ，只能在浏览器和内存历史记录中使用</li>
</ul>
</li>
</ul>
<blockquote>
<blockquote>
<p>访问 match/location 对象：</p>
</blockquote>
<ol>
<li>Route component -&gt; this.props.match/location</li>
<li>Route render -&gt; ({ match/location }) =&gt; ()</li>
<li>Route children -&gt; ({ match/location }) =&gt; ()</li>
</ol>
</blockquote>
<h3 id="20-1-安装路由"><a href="#20-1-安装路由" class="headerlink" title="20.1 安装路由"></a><em>20.1 安装路由</em></h3><ol>
<li>安装<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-router-dom --save</span><br></pre></td></tr></table></figure></li>
<li>安装成功之后，需要使用 ReactRouter 的容器组件，主要包括：</li>
</ol>
<ul>
<li><code>BrowserRouter</code> 浏览器的 history API，history 模式，路径没有 # 号（浏览器自带的H5 API, restful 风格,需要配合后台）</li>
<li><code>HashRouter</code> 通过 hash 路由，路径后面都有 #</li>
<li><code>MemoryRouter</code> 在内存中管理路由（history），地址栏不会发生变化，要在 ReactNative 中使用</li>
</ul>
<h3 id="20-2-基本使用"><a href="#20-2-基本使用" class="headerlink" title="20.2 基本使用"></a><em>20.2 基本使用</em></h3><h4 id="跑通基本路由"><a href="#跑通基本路由" class="headerlink" title="跑通基本路由"></a><em>跑通基本路由</em></h4><ol>
<li>需要从 react-router-dom 中导入 HashRouter、Route 组件<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HashRouter, Route &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br></pre></td></tr></table></figure></li>
<li>HashRouter 尽量放在应用的顶层，HashRouter 要接收一个子节点<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span>)</span><br></pre></td></tr></table></figure></li>
<li>在 HashRouter 下面配置 Route；Route 组件有 <code>path</code> 和 <code>component</code> 两个属性；Route 组件的作用当页面中的路径（url）（如果是 HashRouter 时，# 后面的就是路径）和 Route 的 path 属性的值一样时，就会渲染 component 对应的组件<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 放在 HashRouter - div 的里面</span></span><br><span class="line">&lt;Route path=<span class="string">'/home'</span> component=&#123;Home&#125;&gt;&lt;<span class="regexp">/Route&gt;</span></span><br><span class="line"><span class="regexp">&lt;Route path='/u</span>ser<span class="string">' component=&#123;User&#125;&gt;&lt;/Route&gt;</span></span><br><span class="line"><span class="string">&lt;Route path='</span>/profile<span class="string">' component=&#123;Profile&#125;&gt;&lt;/Route&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：ReactRouter 的容器组件中只能包含一个根 DOM 元素，所以需要在 Route 的外层包裹一个 div 标签</p>
</blockquote>
</li>
</ol>
<h4 id="路由的匹配规则"><a href="#路由的匹配规则" class="headerlink" title="路由的匹配规则"></a><em>路由的匹配规则</em></h4><p>路由的匹配规则：把页面地址栏中的路径从 /home 变为 /home/abc，发现 Home 组件依然在页面中；这是因为路由匹配是<strong>模糊匹配</strong>的，只要开头匹配就认为匹配成功，就会显示对应的组件</p>
<blockquote>
<p>tips：如果有一个组件想让其在任何地方都显示，把它的 path 设为 / 即可</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=<span class="string">'/'</span> component=&#123;Home&#125;&gt;&lt;<span class="regexp">/Route&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="20-3-Link-组件"><a href="#20-3-Link-组件" class="headerlink" title="20.3 Link 组件"></a><em>20.3 Link 组件</em></h3><p>功能和 VueRouter 的 router-link 组件的功能类似，可以设置一个 <code>to</code> 属性，值是一个路径；当点击它的时候可以把页面中 url 的路径切换到 to 属性指定的路径</p>
<blockquote>
<p>Link 会被渲染成一个 a 标签；但是在开发的时候尽量不要写 a 标签，因为路由不仅有 hash 模式还有 history 模式，写 Link 它会自动根据模式切换路径</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Link &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line">&lt;Link to=<span class="string">"/about"</span>&gt;About&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ to 的属性值为一个字符串</span></span><br><span class="line"><span class="regexp">&lt;Link to="/</span>courses?sort=name<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">// to 的属性值为一个对象</span></span><br><span class="line"><span class="string">&lt;Link</span></span><br><span class="line"><span class="string">  to=&#123;&#123;</span></span><br><span class="line"><span class="string">    pathname: "</span>/courses<span class="string">", // 表示链接到的路径的字符串</span></span><br><span class="line"><span class="string">    search: "</span>?sort=name<span class="string">", // 查询参数的字符串表示形式</span></span><br><span class="line">    hash: "#the-hash", // 要放入 URL 的 hash</span><br><span class="line">    state: &#123; <span class="attr">fromDashboard</span>: <span class="literal">true</span> &#125; <span class="comment">// 状态为持久存储到该位置</span></span><br><span class="line">  &#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line"><span class="comment">// to 的属性值为一个函数</span></span><br><span class="line">&lt;Link to=&#123;location =&gt; (&#123; ...location, <span class="attr">pathname</span>: <span class="string">"/courses"</span> &#125;)&#125; /&gt;</span><br><span class="line">&lt;Link to=&#123;location =&gt; <span class="string">`<span class="subst">$&#123;location.pathname&#125;</span>?sort=name`</span>&#125; /&gt;</span><br></pre></td></tr></table></figure>


<h3 id="20-4-嵌套路由（二级路由）"><a href="#20-4-嵌套路由（二级路由）" class="headerlink" title="20.4 嵌套路由（二级路由）"></a><em>20.4 嵌套路由（二级路由）</em></h3><p>很多情况下，在导航下还有二级路由，如 /user 下面还有 /user/list 和 /user/add；类似于 VueRouter 的嵌套路由</p>
<p>如果在 /user 下面有嵌套路由，需要在 /user 对应的组件中添加 Route 组件；新添加的 Route 组件的 path 就是嵌套路由，如 /user/add，component 就是嵌套路由对应的组件</p>
<h3 id="20-5-编程式导航"><a href="#20-5-编程式导航" class="headerlink" title="20.5 编程式导航"></a><em>20.5 编程式导航</em></h3><p>用代码切换路由；所有被路由渲染的组件，它的 props 中都有路由的信息（属性），通过 props 可以取得路由信息；其中 <code>props.history.push()</code> 是用来切换路由的，参数接收一个想去往的路径</p>
<h3 id="20-6-动态路由"><a href="#20-6-动态路由" class="headerlink" title="20.6 动态路由"></a><em>20.6 动态路由</em></h3><p>动态路由路径中有一段是不固定的，如 /user/detail/:id，最后这一段 /:id 就是动态的，<strong>动态路由就是用来传递数据的</strong>；这个路由一般也是嵌套的，所以需要配置 Route 组件；在路由对应的组件中，如果要获取动态路由的参数：<code>props.match.params</code> 对象，如 let { id } = this.props.match.params</p>
<h3 id="20-7-路由匹配-exact、render、Switch组件"><a href="#20-7-路由匹配-exact、render、Switch组件" class="headerlink" title="20.7 路由匹配 - exact、render、Switch组件"></a><em>20.7 路由匹配 - exact、render、Switch组件</em></h3><ol>
<li>默认的路由匹配是模糊匹配的，如果希望路由匹配为精确匹配（严格对某个路径进行匹配）/匹配到某一个路径后就不再匹配了，需要在对应的 Route 上增加一个 <code>exact</code> 属性</li>
<li>Route 组件中有一个 <code>render</code> 属性，值是函数，这个函数要返回一个 jsx 元素或者一个组件，当页面 url 中的路径和 Route 的 path 匹配的时候就会执行 render 对应的函数，并且把它返回的 jsx 元素或者组件渲染到页面中；render 充当的是一个组件的作用</li>
<li>当需要它匹配到一个路由后，后面的就不要再匹配了，此时需要一个 <code>Switch</code> 组件；Switch 组件也是 react-router-dom 的内置组件，导出才能使用<blockquote>
<p>Route 组件要放在 Switch 组件的里面</p>
</blockquote>
</li>
</ol>
<blockquote>
<p>一般一级路由很少有动态的</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Switch, Route &#125; <span class="keyword">from</span> <span class="string">'react-router'</span></span><br><span class="line"></span><br><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Route exact path=<span class="string">"/"</span> component=&#123;Home&#125;/&gt;</span><br><span class="line">  &lt;Route path=<span class="string">"/about"</span> component=&#123;About&#125;/&gt;</span><br><span class="line">  &lt;Route path=<span class="string">"/profile"</span> render=&#123;() =&gt; &#123; <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Profile<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;&#125;/&gt;</span><br><span class="line">  &lt;Route path=<span class="string">"/:user"</span> component=&#123;User&#125;/&gt;</span><br><span class="line">  &lt;Route component=&#123;NoMatch&#125;/&gt;</span><br><span class="line">&lt;<span class="regexp">/Switch&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="20-8-受保护的路由-导航守卫-Redirect-组件"><a href="#20-8-受保护的路由-导航守卫-Redirect-组件" class="headerlink" title="20.8 受保护的路由(导航守卫) - Redirect 组件"></a><em>20.8 受保护的路由(导航守卫) - Redirect 组件</em></h3><p>真实的项目中，回去一些路由进行保护，如登录后才能访问；类似于 VueRouter 的导航守卫，该功能需要依靠高阶组件实现（用高阶组件包装 Route）</p>
<ul>
<li>Redirect 组件（ReactRouter 中的组件）是用来重定向的，其中 to 属性表示要重定向到的 url，属性值可以是一个字符串也可以是一个对象；<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// to 属性为字符串</span></span><br><span class="line">&lt;Redirect to=<span class="string">"/somewhere/else"</span> /&gt;</span><br><span class="line"><span class="comment">// to 属性为对象</span></span><br><span class="line">&lt;Redirect</span><br><span class="line">  to=&#123;&#123;</span><br><span class="line">    pathname: <span class="string">"/login"</span>,</span><br><span class="line">    search: <span class="string">"?utm=your+face"</span>,</span><br><span class="line">    state: &#123; <span class="attr">referrer</span>: currentLocation &#125;</span><br><span class="line">  &#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Redirect <span class="keyword">from</span>=<span class="string">'/old-path'</span> to=<span class="string">'/new-path'</span>/&gt;</span><br><span class="line">  &lt;Route path=<span class="string">'/new-path'</span> component=&#123;Place&#125;/&gt;</span><br><span class="line">&lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ Redirect with matched parameters</span></span><br><span class="line"><span class="regexp">&lt;Switch&gt;</span></span><br><span class="line"><span class="regexp">  &lt;Redirect from='/u</span>sers/:id<span class="string">' to='</span>/users/profile/:id<span class="string">'/&gt;</span></span><br><span class="line"><span class="string">  &lt;Route path='</span>/users/profile/:id<span class="string">' component=&#123;Profile&#125;/&gt;</span></span><br><span class="line"><span class="string">&lt;/Switch&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="20-9-自定义菜单-amp-NavLink组件"><a href="#20-9-自定义菜单-amp-NavLink组件" class="headerlink" title="20.9 自定义菜单&amp;NavLink组件"></a><em>20.9 自定义菜单&amp;NavLink组件</em></h3><ul>
<li><p>自定义菜单：通常情况下，会给激活的菜单做选中样式，所以需要使用高阶组件进行包装；</p>
<blockquote>
<p>用自定义的组件来替换 Link 组件，在自定义的组件中做对应的要求。例如：当菜单选中的时候需要激活的样式，我们需要包装 Link 组件，用包装后的组件替换原有的 Link</p>
</blockquote>
</li>
<li><p>NavLink</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavLink &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line">&lt;NavLink to=<span class="string">"/about"</span>&gt;About&lt;<span class="regexp">/NavLink&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;NavLink to="/</span>faq<span class="string">" activeClassName="</span>selected<span class="string">"&gt;</span></span><br><span class="line"><span class="string">  FAQs</span></span><br><span class="line"><span class="string">&lt;/NavLink&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;NavLink</span></span><br><span class="line"><span class="string">  to="</span>/faq<span class="string">"</span></span><br><span class="line"><span class="string">  activeStyle=&#123;&#123;</span></span><br><span class="line"><span class="string">    fontWeight: "</span>bold<span class="string">",</span></span><br><span class="line"><span class="string">    color: "</span>red<span class="string">"</span></span><br><span class="line"><span class="string">  &#125;&#125;</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">  FAQs</span></span><br><span class="line"><span class="string">&lt;/NavLink&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="20-10-Prompt-组件"><a href="#20-10-Prompt-组件" class="headerlink" title="20.10 Prompt 组件"></a><em>20.10 Prompt 组件</em></h3><p>有的时候，在用户在某个页面进行了一些操作，但是没有保存就要去另一个页面，如果需要提醒一下用户是否跳转，需要使用 reactRouter 的 Prompt 组件</p>
<ul>
<li>在 Prompt 中有两个属性：<ul>
<li>when：值是 boolean，如果值为 true 时离开当前未保存操作界面才会提示，false 则不提示</li>
<li>message：值是一个函数，接收要去往的路由信息对象，返回离开当前页面时的提示信息<blockquote>
<p>注意：setState 是异步的，所以需要写在 setState 的回调函数中</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Prompt &#125; <span class="keyword">from</span> <span class="string">'react-router'</span></span><br><span class="line"></span><br><span class="line">&lt;Prompt</span><br><span class="line">  when=&#123;formIsHalfFilledOut&#125;</span><br><span class="line">  message=<span class="string">"Are you sure you want to leave?"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="20-11-NotFound-页面"><a href="#20-11-NotFound-页面" class="headerlink" title="20.11 NotFound 页面"></a><em>20.11 NotFound 页面</em></h3><ul>
<li>设置 NotFound 页面：</li>
</ul>
<p>当路由不匹配时，需要返回一个 404 页面，所以需要增加一个 404 组件，配置一个 Route，这个 Route 的 component 设置为 404 的组件，但是不设置 path 属性；当所有其他 Route 的 path 都不匹配时就会自动返回没有 path 的 Route</p>
<blockquote>
<p>设置 Route 组件，但是不设置 path 属性；只设置 component 属性；当其他带有 path 的 Route 都没能匹配到当前页面的路径时，就会渲染这没有 path 的 Route 对应的 component</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route component=&#123;NotMatch&#125;/&gt;</span><br></pre></td></tr></table></figure>

<h3 id="20-12-React-router-练习"><a href="#20-12-React-router-练习" class="headerlink" title="20.12 React-router 练习"></a><em>20.12 React-router 练习</em></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">项目目录</span><br><span class="line">├── src</span><br><span class="line">│   ├── index.js【将整合后的 App.js 渲染到页面中】</span><br><span class="line">│   ├── index.css</span><br><span class="line">│   ├── App.js【将组件整合后导入 index.js】</span><br><span class="line">│   ├── App.css</span><br><span class="line">│   ├── components【组件】</span><br><span class="line">│   │   ├── Home.js【一级路由：首页】</span><br><span class="line">│   │   ├── User.js【一级路由：用户管理】</span><br><span class="line">│   │   ├── Profile.js【一级路由：个人中心】</span><br><span class="line">│   │   ├── Login.js【一级路由：登录】</span><br><span class="line">│   │   ├── UserList.js【二级路由：用户列表】</span><br><span class="line">│   │   ├── UserAdd.js【二级路由：添加用户】</span><br><span class="line">│   │   ├── UserDetail.js【用户详情】</span><br><span class="line">│   │   ├── MenuLink.js【自定义菜单：改变原有 Link】</span><br><span class="line">│   │   ├── text.css【自定义菜单添加的样式属性】</span><br><span class="line">│   │   ├── Protected.js【受保护的路由（导航守卫）】</span><br><span class="line">│   │   └── NotFound.js【NotFound 页面】</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.css'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HashRouter, Route &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">App</span>&gt;</span><span class="tag">&lt;/<span class="name">App</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</span><br></pre></td></tr></table></figure>
<p>App.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.min.css'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Link, Route, Switch &#125; <span class="keyword">from</span> <span class="string">"react-router-dom"</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">"./components/Home"</span>;</span><br><span class="line"><span class="keyword">import</span> User <span class="keyword">from</span> <span class="string">"./components/User"</span>;</span><br><span class="line"><span class="keyword">import</span> Profile <span class="keyword">from</span> <span class="string">"./components/Profile"</span>;</span><br><span class="line"><span class="keyword">import</span> Login <span class="keyword">from</span> <span class="string">"./components/Login"</span>;</span><br><span class="line"><span class="keyword">import</span> PrivateRoute <span class="keyword">from</span> <span class="string">'./components/Protected'</span></span><br><span class="line"><span class="keyword">import</span> NotFound <span class="keyword">from</span> <span class="string">"./components/NotFound"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;div className="navbar-inverse navbar"&gt;</span><br><span class="line">        &lt;div className="container-fluid"&gt;</span><br><span class="line">          &lt;div className="navbar-header"&gt;</span><br><span class="line">            &lt;div className="navbar-brand"&gt;</span><br><span class="line">              用户管理系统</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;ul className="navbar-nav nav"&gt;</span><br><span class="line">              &lt;li&gt;&lt;Link to='/home'&gt;首页&lt;/Link&gt;&lt;/li&gt;</span><br><span class="line">              &lt;li&gt;&lt;Link to='/user'&gt;用户管理&lt;/Link&gt;&lt;/li&gt;</span><br><span class="line">              &lt;li&gt;&lt;Link to='/profile'&gt;个人中心&lt;/Link&gt;&lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;div className="container"&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">          &#123;/* / 表示任何地方都会渲染这个，其中 exact 表示精确匹配，render 表示*/&#125;</span><br><span class="line">          &lt;Route path='/' exact render=&#123;() =&gt; &lt;h1&gt;首页&lt;/h1&gt;&#125;&gt;&lt;/Route&gt;</span><br><span class="line"></span><br><span class="line">          &#123;/* /:name 表示的是一个动态路由，规则 / 后面跟其他；所以 /home /user /profile 都符合这个规则，就都被 /:name 匹配到了；此时会发现页面访问 /home /user /profile 都会展示 mars */&#125;</span><br><span class="line">          &#123;/*&lt;Route path='/:name' render=&#123;() =&gt; &lt;h1&gt;mars&lt;/h1&gt;&#125;&gt;&lt;/Route&gt;*/&#125;</span><br><span class="line"></span><br><span class="line">          &lt;Route path='/home' component=&#123;Home&#125;&gt;&lt;/Route&gt;</span><br><span class="line">          &lt;PrivateRoute path='/user' component=&#123;User&#125;&gt;&lt;/PrivateRoute&gt;</span><br><span class="line">          &lt;PrivateRoute path='/profile' component=&#123;Profile&#125;&gt;&lt;/PrivateRoute&gt;</span><br><span class="line">          &lt;Route path='/login' component=&#123;Login&#125;&gt;&lt;/Route&gt;</span><br><span class="line">          &lt;Route component=&#123;NotFound&#125;&gt;&lt;/Route&gt;</span><br><span class="line">        &lt;/Switch&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>
<p>components/Home.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home</span><br></pre></td></tr></table></figure>
<p>components/User.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Route, Link &#125; <span class="keyword">from</span> <span class="string">"react-router-dom"</span>;</span><br><span class="line"><span class="keyword">import</span> UserAdd <span class="keyword">from</span> <span class="string">"./UserAdd"</span>;</span><br><span class="line"><span class="keyword">import</span> UserList <span class="keyword">from</span> <span class="string">"./UserList"</span>;</span><br><span class="line"><span class="keyword">import</span> UserDetail <span class="keyword">from</span> <span class="string">"./UserDetail"</span>;</span><br><span class="line"><span class="keyword">import</span> MenuLink <span class="keyword">from</span> <span class="string">'./MenuLink'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">let</span> json = [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/user/add'</span>,</span><br><span class="line">        component: UserAdd</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/user/list'</span>,</span><br><span class="line">        component: UserList</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/user/detail/:id'</span>,</span><br><span class="line">        component: UserDetail</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>User<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">      &lt;div className="row"&gt;</span><br><span class="line">        &lt;div className="col-md-2"&gt;</span><br><span class="line">          &#123;/*&lt;li&gt;*/&#125;</span><br><span class="line">          &#123;/*  &lt;Link to='/user/add'&gt;新增用户&lt;/Link&gt;*/&#125;</span><br><span class="line">          &#123;/*&lt;/li&gt;*/&#125;</span><br><span class="line">          &#123;/*&lt;li&gt;*/&#125;</span><br><span class="line">          &#123;/*  &lt;Link to='/user/list'&gt;用户列表&lt;/Link&gt;*/&#125;</span><br><span class="line">          &#123;/*&lt;/li&gt;*/&#125;</span><br><span class="line">          &lt;MenuLink to='/user/add' label='新增用户'&gt;&lt;/MenuLink&gt;</span><br><span class="line">          &lt;MenuLink to='/user/list' label='用户列表'&gt;&lt;/MenuLink&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div className="col-md-10"&gt;</span><br><span class="line">          &#123;/*&lt;Route path='/user/add' component=&#123;UserAdd&#125;&gt;&lt;/Route&gt;*/&#125;</span><br><span class="line">          &#123;/*&lt;Route path='/user/list' component=&#123;UserList&#125;&gt;&lt;/Route&gt;*/&#125;</span><br><span class="line">          &#123;/*&lt;Route path='/user/detail/:id' component=&#123;UserDetail&#125;&gt;&lt;/Route&gt;*/&#125;</span><br><span class="line"></span><br><span class="line">          &#123;/* 方法二：将需要 Route 的 path 和 component 写到一个 json 中，然后通过 map 方法渲染出来 */&#125;</span><br><span class="line">          &#123;</span><br><span class="line">            json.map((item, index) =&gt; &#123;</span><br><span class="line">              // 相当于 Vue-router 和 router-view 二合一</span><br><span class="line">              return &lt;Route path=&#123;item.path&#125; component=&#123;item.component&#125; key=&#123;index&#125;&gt;&lt;/Route&gt;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> User</span><br></pre></td></tr></table></figure>
<p>components/UserAdd.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Prompt &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAdd</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      name: <span class="string">''</span>,</span><br><span class="line">      show: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  submit = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 点击保存时把 input 框中的内容保存到 localStorage 中</span></span><br><span class="line">    <span class="keyword">let</span> listStr = localStorage.getItem(<span class="string">'list'</span>)</span><br><span class="line">    <span class="keyword">let</span> list = listStr ? <span class="built_in">JSON</span>.parse(listStr) : []</span><br><span class="line">    list.push(&#123;</span><br><span class="line">      id: <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">100</span>),</span><br><span class="line">      name: <span class="keyword">this</span>.state.name</span><br><span class="line">    &#125;)</span><br><span class="line">    localStorage.setItem(<span class="string">'list'</span>, <span class="built_in">JSON</span>.stringify(list))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存成功后，再切换路由就不需要拦截了</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      show: <span class="literal">false</span></span><br><span class="line">    &#125;, () =&gt; &#123;</span><br><span class="line">      <span class="comment">// setState() 是异步的，等 show 变为 false 以后再跳走，所以要把切换路由写在</span></span><br><span class="line">      <span class="comment">// 保存成功之后要跳转到 /user/list</span></span><br><span class="line">      <span class="keyword">this</span>.props.history.push(<span class="string">'/user/list'</span>) <span class="comment">// react-router 会把路由相关的信息放到组件的 props 上，history.push() 是通过代码切换路由的方法；参数就是想去的路由</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;/* Prompt 组件接收两个属性：*/&#125;</span></span><br><span class="line"><span class="xml">      &#123;/* when：是一个 boolean，如果为 true，切换路由就会进行提示，如果为 false 则不提示 */&#125;</span></span><br><span class="line"><span class="xml">      &#123;/* message：是一个函数，这个函数接收一个 props，这个 props 是当前它要去往的路由对象 */&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Prompt</span> <span class="attr">when</span>=<span class="string">&#123;this.state.show&#125;</span> <span class="attr">message</span>=<span class="string">&#123;(location)</span> =&gt;</span> `当前操作未保存，真的要去$&#123;location.pathname&#125;么？`&#125;&gt;<span class="tag">&lt;/<span class="name">Prompt</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>UserAdd<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">      &lt;div className="form-group"&gt;</span><br><span class="line">        &lt;label htmlFor="uName"</span><br><span class="line">               className='control-label'&gt;用户名&lt;/label&gt;</span><br><span class="line">        &lt;input type="text"</span><br><span class="line">               className="form-control"</span><br><span class="line">               value=&#123;this.state.name&#125;</span><br><span class="line">          // onChange=&#123;(e) =&gt; this.setState(&#123;name: e.target.value&#125;)</span><br><span class="line">               onChange=&#123;(e) =&gt; &#123;</span><br><span class="line">                 this.setState(&#123;name: e.target.value&#125;)</span><br><span class="line">                 if (e.target.value.length) &#123;</span><br><span class="line">                   this.setState(&#123;</span><br><span class="line">                     show: true</span><br><span class="line">                   &#125;)</span><br><span class="line">                 &#125;</span><br><span class="line">               &#125;</span><br><span class="line">        &#125;/&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;div className="form-group"&gt;</span><br><span class="line">        &lt;button className="btn btn-success"</span><br><span class="line">                onClick=&#123;this.submit&#125;&gt;添加</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> UserAdd</span><br></pre></td></tr></table></figure>
<p>components/UserList.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Link &#125; <span class="keyword">from</span> <span class="string">"react-router-dom"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      list: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  UNSAFE_componentWillMount() &#123;</span><br><span class="line">    <span class="keyword">let</span> listStr = localStorage.getItem(<span class="string">'list'</span>)</span><br><span class="line">    <span class="keyword">let</span> list = listStr ? <span class="built_in">JSON</span>.parse(listStr) : []</span><br><span class="line">    <span class="keyword">if</span> (list.length) <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      list</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>UserList<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">      &lt;ul className="list-group"&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          this.state.list.map((item, index) =&gt; &#123;</span><br><span class="line">            return &lt;li className='list-group-item' key=&#123;index&#125;&gt;</span><br><span class="line">              &lt;Link to=&#123;`/user/detail/$&#123;item.id&#125;`&#125;&gt;</span><br><span class="line">                Id: &#123;item.id&#125;; Name: &#123;item.name&#125;</span><br><span class="line">              &lt;/Link&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> UserList</span><br></pre></td></tr></table></figure>
<p>components/UserDetail.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 从动态路由中获取用户的 id；然后从 localStorage 中获取到该 id 对应的用户信息，展示到页面中</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserDetail</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      user: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  UNSAFE_componentWillMount() &#123;</span><br><span class="line">    <span class="comment">// props.match.params 属性是动态路由参数对象，属性名是 动态路由设置的时候冒号后面的值，值是动态路由具体的值</span></span><br><span class="line">    <span class="keyword">let</span> &#123; id &#125; = <span class="keyword">this</span>.props.match.params</span><br><span class="line">    <span class="comment">// console.log(id);</span></span><br><span class="line">    <span class="comment">// console.log(this.props);</span></span><br><span class="line">    <span class="keyword">let</span> listStr = localStorage.getItem(<span class="string">'list'</span>)</span><br><span class="line">    <span class="keyword">let</span> list = <span class="built_in">JSON</span>.parse(listStr)</span><br><span class="line">    <span class="keyword">let</span> user = list.find(<span class="function"><span class="params">i</span> =&gt;</span> +i.id === +id)</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      user</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">      Users Id is &#123;this.state.user.id&#125; and Name is &#123;this.state.user.name&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> UserDetail</span><br></pre></td></tr></table></figure>
<p>components/Profile.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Profile<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Profile</span><br></pre></td></tr></table></figure>
<p>components/Login.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当点击到 用户管理 和 个人中心 需要做登录判断</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;div className="form-group"&gt;</span><br><span class="line">        &lt;label htmlFor="uName"</span><br><span class="line">               className='control-label'&gt;用户名&lt;/label&gt;</span><br><span class="line">        &lt;input type="text" className='form-control'/&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;div className="form-group"&gt;</span><br><span class="line">        &lt;button className="btn btn-success" onClick=&#123;() =&gt; &#123;</span><br><span class="line">          localStorage.setItem('loginSystem', 'true')</span><br><span class="line">          console.log(this.props)</span><br><span class="line">          // 登录之后还要跳转回去</span><br><span class="line">          this.props.history.push(this.props.location.from)</span><br><span class="line">        &#125;&#125;&gt;</span><br><span class="line">          登录</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Login</span><br></pre></td></tr></table></figure>
<p>components/MenuLink.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当菜单选中的时候需要激活的样式，需要包装 Link 组件；用包装后的组件替换原有的 Link</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Route, Link &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./text.css'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用到函数式组件的渲染过程</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; to, label &#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;to&#125;</span> <span class="attr">children</span>=<span class="string">&#123;(props)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="xml">    // props 是路由信息对象</span></span><br><span class="line"><span class="xml">    // Route 的 children 和 render 类似，但是 render 是 path 匹配的时候才会执行，而 children 是不管路径匹配与否都会执行；</span></span><br><span class="line"><span class="xml">    // children 也需要返回一个 jsx 或者一个组件，这个组件或者 jsx 将会被渲染到页面中</span></span><br><span class="line">    return &lt;li className=&#123;props.match ? 'active' : ''&#125;&gt;</span><br><span class="line">      &lt;Link to=&#123;to&#125;&gt;&#123;label&#125;&lt;/Link&gt;</span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  &#125;&#125;/&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>components/text.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: skyblue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">li</span><span class="selector-class">.active</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>components/Protected.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为了实现对路由的保护，需要对 Route 组件进行包装，用包装过后的组件来替换 Route 组件</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">import</span> &#123; Route, Redirect &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;<span class="attr">component</span>: Component, ...others&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Route</span> &#123;<span class="attr">...others</span>&#125; <span class="attr">render</span>=<span class="string">&#123;(props)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="xml">    // props 就是当前路由对象的信息</span></span><br><span class="line"><span class="xml">    // 这个 render 会在 Route 的 path 和当前 url 中的路径匹配的时候执行</span></span><br><span class="line"><span class="xml">    // 我们可以在这里判断用户登录状态，如果登录就返回 component，否则需要重定向</span></span><br><span class="line"><span class="xml">    console.log(props);</span></span><br><span class="line"><span class="xml">    return localStorage.getItem('loginSystem')</span></span><br><span class="line"><span class="xml">        ? <span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line"><span class="xml">        : <span class="tag">&lt;<span class="name">Redirect</span> <span class="attr">to</span>=<span class="string">&#123;&#123;pathname:</span> '/<span class="attr">login</span>', <span class="attr">from:</span> <span class="attr">props.match.url</span>&#125;&#125;/&gt;</span></span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  &#125;&gt;<span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>components/NotFound.js</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotFound</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>NOT FOUND<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> NotFound</span><br></pre></td></tr></table></figure>
<!-- flag of hidden posts --></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:edsyang1102@gmail.com">Edsyang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://blog.lagerstroemia.com.cn/2019/09/01/course/react/14-React.js-E.part%20five/">http://blog.lagerstroemia.com.cn/2019/09/01/course/react/14-React.js-E.part%20five/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.lagerstroemia.com.cn" target="_blank">Edsyang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JS-Notes/">JS Notes</a></div><div class="post_share"><div class="social-share" data-image="https://tva1.sinaimg.cn/large/0081Kckwly1gk0v7wm1ctj31jk0lm75k.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.png" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'WgFk4Onl7sisfXpq9vHcehGJ-gzGzoHsz',
  appKey: '3DLR7iLY5al5dbIdo9kWnDHU',
  notify: false,
  verify: false,
  placeholder: 'Please leave your footprints',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'en',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: true,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Edsyang</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.miit.gov.cn/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>冀ICP备19038398号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/search/local-search.js"></script></body></html>